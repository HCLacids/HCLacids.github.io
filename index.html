<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="HCL's Blog" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":true},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    translation: {
      copy_button: '复制',
      copy_success: '复制成功',
      copy_failure: '复制失败'
    },
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="Fighting!">
<meta property="og:type" content="website">
<meta property="og:title" content="HCL&#39;s Blog">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;index.html">
<meta property="og:site_name" content="HCL&#39;s Blog">
<meta property="og:description" content="Fighting!">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>HCL's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">HCL's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">Recording the study progress</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类<span class="badge">0</span></a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档<span class="badge">15</span></a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/11/23/this%20pointer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/11/23/this%20pointer/" class="post-title-link" itemprop="url">this pointer</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-11-23 10:20:03" itemprop="dateCreated datePublished" datetime="2021-11-23T10:20:03+08:00">2021-11-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="今天主要是总结一下看的书的第一小节，主要是关于this指针的指向问题和new关键字的实现与bind的实现的知识点。">今天主要是总结一下看的书的第一小节，主要是关于<code>this</code>指针的指向问题和<code>new</code>关键字的实现与<code>bind</code>的实现的知识点。</h5>
<h3 id="this指针">this指针</h3>
<p><code>this</code>指针总的来说用一句话总结就是<code>谁调用就指向谁</code>。但是还是不太全面，所以我们将分以下几个部分来总结：1. 显示绑定 2. 隐式绑定 3. <code>new</code>关键字 4. 箭头函数 5. 混合的优先级</p>
<h4 id="显示绑定">显示绑定</h4>
<p>显示绑定的函数有<code>bind</code>，<code>call</code>和<code>apply</code>。他们之间没有什么大的区别，区别在于之后的传参的形式和返回的值。</p>
<p><code>call</code>和<code>apply</code>回立刻执行函数，而<code>bind</code>是返回绑定<code>this</code>指向的函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> target = &#123;&#125;</span><br><span class="line">fn.call(target, <span class="string">'arg1'</span>, <span class="string">'arg2'</span>);</span><br><span class="line"></span><br><span class="line">fn.apply(target, [<span class="string">'arg1'</span>, <span class="string">'arg2'</span>]);</span><br><span class="line"></span><br><span class="line">fn.bind(target, <span class="string">'arg1'</span>, <span class="string">'arg2'</span>)();</span><br></pre></td></tr></table></figure>
<h4 id="隐式绑定">隐式绑定</h4>
<p>那么隐式绑定的口诀就是我们说的那一句话。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = &#123;</span><br><span class="line">    name: <span class="string">'Lucas'</span>,</span><br><span class="line">    fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">        &#125;,</span><br><span class="line">    brother: &#123;</span><br><span class="line">        name: <span class="string">'Mike'</span>,</span><br><span class="line">        fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fn1 = person.brother.fn;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(fn1());</span><br><span class="line"><span class="built_in">console</span>.log(person.fn());</span><br><span class="line"><span class="built_in">console</span>.log(person.brother.fn());</span><br></pre></td></tr></table></figure>
<h4 id="new关键字">new关键字</h4>
<p><code>new</code>关键字生成的实例中，this的指向为该对象。</p>
<p>关于new关键字的更多操作在之后讲。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> person = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = <span class="string">'Lucas'</span>,</span><br><span class="line">    <span class="keyword">this</span>.fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">        &#125;,</span><br><span class="line">    <span class="keyword">this</span>.brother = &#123;</span><br><span class="line">        name: <span class="string">'Mike'</span>,</span><br><span class="line">        fn: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> person().fn());</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">new</span> person().brother.fn());</span><br></pre></td></tr></table></figure>
<h4 id="箭头函数">箭头函数</h4>
<p>箭头函数是<code>es6</code>中的新特性，他本身没有this指针。所以this指针的指向是在形成时，其外部作用域（函数作用域或者全局作用域）的指向。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123;</span><br><span class="line">	fn:<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    fn2: (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">    &#125;)()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.fn())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(a.fn2())</span><br></pre></td></tr></table></figure>
<h4 id="this的优先级"><code>this</code>的优先级</h4>
<p><code>new</code>关键字高于显示绑定高于隐式绑定，箭头函数的<code>this</code>不能被改变。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">a</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    a: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = foo.call(obj1)</span><br><span class="line"><span class="built_in">console</span>.log(bar.call(obj2))</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">123</span>					<span class="comment">// const a = 1;</span></span><br><span class="line"><span class="keyword">const</span> foo= <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">a</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj1 = &#123;</span><br><span class="line">    a: <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> obj2 = &#123;</span><br><span class="line">    a: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> bar = foo.call(obj1)</span><br><span class="line"><span class="built_in">console</span>.log(bar.call(obj2))</span><br></pre></td></tr></table></figure>
<p><code>const</code>声明的变量不会挂载在window对象上。</p>
<h3 id="new关键字实现">new关键字实现</h3>
<ol>
<li>创建新对象，将对象的<code>__proto__</code>指向函数的<code>prototype</code></li>
<li>将属性挂在新对象上</li>
<li><code>this</code>的指向指向新对象</li>
<li>如果没有返回对象则返回<code>this</code>，否则返回该对象</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _new = <span class="function"><span class="keyword">function</span>(<span class="params">fn, ...arg</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="built_in">Object</span>.create(fn.prototype); <span class="comment">//1</span></span><br><span class="line">    <span class="keyword">const</span> res = fn.apply(obj, arg); <span class="comment">//2,3</span></span><br><span class="line">    <span class="keyword">return</span> res <span class="keyword">instanceof</span> <span class="built_in">Object</span> ? res : object; <span class="comment">//4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="bind实现">bind实现</h3>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> _bind = <span class="built_in">Function</span>.prototype.bind || <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> me = <span class="keyword">this</span></span><br><span class="line">    <span class="keyword">var</span> context = <span class="built_in">Array</span>.prototype.shift.call(<span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">var</span> arg = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="title">bound</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> innnerArg = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>)</span><br><span class="line">        <span class="keyword">var</span> args = arg.contact(innerArg);</span><br><span class="line">        <span class="keyword">return</span> me.apply(context, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/10/08/Echarts%20Project%20Summary/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/10/08/Echarts%20Project%20Summary/" class="post-title-link" itemprop="url">Echarts Project Summary</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-08 17:18:04" itemprop="dateCreated datePublished" datetime="2021-10-08T17:18:04+08:00">2021-10-08</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p> 2021年的暑期在summer2021的活动当中找了一个开源项目，并且在学姐的建议下找一个比较大的开源团队（Apache）项目去写。最终也是捡漏捡到了Echarts的这样一个高难度的项目去写。（只有我一个人报了这个项目</p>
<p>现在写这篇博客的时候正是9月22日，还有几天就要期末考核了，但是我的导师还是没有review我的代码和对第二个需求的详细解答。我也很无奈，很想结项啊！！！把我的code合进去也不擦啊啊啊！</p>
<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><p>当时接到需求的时候大概心里是有了个想法的，“关于节点自指”，其实就是节点的边信息当中的始末节点都为一个节点。有了想法就去实施，我把仓库clone下来时，我又懵了。只知道按照惯例开始往src里面找代码。</p>
<p><img src="https://i.loli.net/2021/10/08/ogLJvk2htVNZiEW.png" alt="image-20210922105406715.png"></p>
<p>在这里我利用了搜索工具，搜索了一下graph这么个关键字，找到了对应的文件夹，开始啥也不懂的乱看。这里有提到test文件夹里面的例子，其实是已经帮我们链接好了，所以我反复对比官网和代码。找到了可以改变内容的代码之后，立马跑过去问导师了，导师也给出了相应的回复，这时才慢慢走上了正道。</p>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><p>突然想起来我刚刚开始看的时候是把几个类看了才开始写的。类也是面向对象最基本的思想，我涉及部分的类有Graph类、GraphNode类、GraphEdge类、List类、Line类。现在想想只有最开始把这些类搞清楚了，到后面看代码的时候才对一些方法和属性搞糊涂。</p>
<p>Graph类，是最基础的图类，其中有GraphNode数组和Graph Edge数组作为属性，data和edgeData两个List类。以及一些其他的方法和属性。这里最主要的就是这些。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Graph &#123;</span><br><span class="line">    <span class="keyword">type</span>: <span class="string">'graph'</span> = <span class="string">'graph'</span>;</span><br><span class="line"></span><br><span class="line">    readonly nodes: GraphNode[] = [];</span><br><span class="line"></span><br><span class="line">    readonly edges: GraphEdge[] = [];</span><br><span class="line"></span><br><span class="line">    data: List;</span><br><span class="line"></span><br><span class="line">    edgeData: List;</span><br><span class="line">    </span><br><span class="line">   	...<span class="comment">//部分代码展示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GraphNode类，是图结点类</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> GraphNode &#123;</span><br><span class="line"></span><br><span class="line">    id: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    inEdges: GraphEdge[] = [];</span><br><span class="line"></span><br><span class="line">    outEdges: GraphEdge[] = [];</span><br><span class="line"></span><br><span class="line">    edges: GraphEdge[] = [];</span><br><span class="line"></span><br><span class="line">    hostGraph: Graph;</span><br><span class="line"></span><br><span class="line">    dataIndex: <span class="built_in">number</span> = <span class="number">-1</span>;</span><br><span class="line">   	...<span class="comment">//部分代码展示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GraphEdge类，是图关系类</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> GraphEdge &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The first node. If directed graph, it represents the source node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    node1: GraphNode;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The second node. If directed graph, it represents the target node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    node2: GraphNode;</span><br><span class="line"></span><br><span class="line">    dataIndex: <span class="built_in">number</span> = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    hostGraph: Graph;</span><br><span class="line">  	...<span class="comment">//部分代码展示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>List类</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> List&lt;</span><br><span class="line">    HostModel <span class="keyword">extends</span> Model = Model,</span><br><span class="line">    Visual <span class="keyword">extends</span> DefaultDataVisual = DefaultDataVisual</span><br><span class="line">&gt; &#123;</span><br><span class="line"></span><br><span class="line">    readonly <span class="keyword">type</span> = <span class="string">'list'</span>;</span><br><span class="line"></span><br><span class="line">    readonly dimensions: <span class="built_in">string</span>[];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Infomation of each data dimension, like data type.</span></span><br><span class="line">    <span class="keyword">private</span> _dimensionInfos: &#123;[dimName: <span class="built_in">string</span>]: DataDimensionInfo&#125;;</span><br><span class="line"></span><br><span class="line">    readonly hostModel: HostModel;</span><br><span class="line">    ...<span class="comment">//部分代码展示</span></span><br><span class="line">      <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">    setItemVisual&lt;K <span class="keyword">extends</span> keyof Visual&gt;(idx: <span class="built_in">number</span>, key: K, value: Visual[K]): <span class="built_in">void</span>;</span><br><span class="line">    setItemVisual(idx: <span class="built_in">number</span>, kvObject: Partial&lt;Visual&gt;): <span class="built_in">void</span>;</span><br><span class="line">    <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">    setItemVisual&lt;K <span class="keyword">extends</span> keyof Visual&gt;(idx: <span class="built_in">number</span>, key: K | Partial&lt;Visual&gt;, value?: Visual[K]): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> itemVisual = <span class="keyword">this</span>._itemVisuals[idx] || &#123;&#125;;</span><br><span class="line">        <span class="keyword">this</span>._itemVisuals[idx] = itemVisual;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isObject(key)) &#123;</span><br><span class="line">            zrUtil.extend(itemVisual, key);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            itemVisual[key <span class="keyword">as</span> <span class="built_in">string</span>] = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    setLayout(key: <span class="built_in">string</span>, val: <span class="built_in">any</span>): <span class="built_in">void</span>;</span><br><span class="line">    setLayout(kvObj: Dictionary&lt;<span class="built_in">any</span>&gt;): <span class="built_in">void</span>;</span><br><span class="line">    setLayout(key: <span class="built_in">string</span> | Dictionary&lt;<span class="built_in">any</span>&gt;, val?: <span class="built_in">any</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (isObject(key)) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">const</span> name <span class="keyword">in</span> key) &#123;</span><br><span class="line">                <span class="keyword">if</span> (key.hasOwnProperty(name)) &#123;</span><br><span class="line">                    <span class="keyword">this</span>.setLayout(name, key[name]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>._layout[key] = val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get layout property.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getLayout(key: <span class="built_in">string</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._layout[key];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Get layout of single data item</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    getItemLayout(idx: <span class="built_in">number</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._itemLayouts[idx];</span><br><span class="line">    &#125;</span><br><span class="line">	...<span class="comment">//部分代码展示</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Bezire-curve"><a href="#Bezire-curve" class="headerlink" title="Bezire curve"></a>Bezire curve</h2><p><a href="https://www.jianshu.com/p/8f82db9556d2" target="_blank" rel="noopener">https://www.jianshu.com/p/8f82db9556d2</a></p>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><p>实现贝塞尔曲线。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createLine</span>(<span class="params">points: <span class="built_in">number</span>[][]</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> line = <span class="keyword">new</span> ECLinePath(&#123;</span><br><span class="line">        name: <span class="string">'line'</span>,</span><br><span class="line">        subPixelOptimize: <span class="literal">true</span></span><br><span class="line">    &#125;);</span><br><span class="line">    setLinePoints(line.shape, points);</span><br><span class="line">    <span class="keyword">return</span> line;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">setLinePoints</span>(<span class="params">targetShape: ECLinePath['shape'], points: <span class="built_in">number</span>[][]</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">type</span> CurveShape = ECLinePath[<span class="string">'shape'</span>] &amp; &#123;</span><br><span class="line">        cpx1: <span class="built_in">number</span></span><br><span class="line">        cpy1: <span class="built_in">number</span></span><br><span class="line">        cpx2?: <span class="built_in">number</span></span><br><span class="line">        cpy2?: <span class="built_in">number</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    targetShape.x1 = points[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    targetShape.y1 = points[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    targetShape.x2 = points[<span class="number">1</span>][<span class="number">0</span>];</span><br><span class="line">    targetShape.y2 = points[<span class="number">1</span>][<span class="number">1</span>];</span><br><span class="line">    targetShape.percent = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> cp1 = points[<span class="number">2</span>];</span><br><span class="line">    <span class="keyword">const</span> cp2 = points[<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cp1) &#123;</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpx1 = cp1[<span class="number">0</span>];</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpy1 = cp1[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpx1 = <span class="literal">NaN</span>;</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpy1 = <span class="literal">NaN</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (cp2) &#123;</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpx2 = cp2[<span class="number">0</span>];</span><br><span class="line">        (targetShape <span class="keyword">as</span> CurveShape).cpy2 = cp2[<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Line <span class="keyword">extends</span> graphic.Group &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> _fromSymbolType: <span class="built_in">string</span>;</span><br><span class="line">    <span class="keyword">private</span> _toSymbolType: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params">lineData: List, idx: <span class="built_in">number</span>, seriesScope?: LineDrawSeriesScope</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        <span class="keyword">this</span>._createLine(lineData <span class="keyword">as</span> LineList, idx, seriesScope);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    _createLine(lineData: LineList, idx: <span class="built_in">number</span>, seriesScope?: LineDrawSeriesScope) &#123;</span><br><span class="line">        <span class="keyword">const</span> seriesModel = lineData.hostModel;</span><br><span class="line">        <span class="keyword">const</span> linePoints = lineData.getItemLayout(idx);</span><br><span class="line">        <span class="keyword">const</span> line = createLine(linePoints);</span><br><span class="line">        line.shape.percent = <span class="number">0</span>;</span><br><span class="line">        graphic.initProps(line, &#123;</span><br><span class="line">            shape: &#123;</span><br><span class="line">                percent: <span class="number">1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, seriesModel, idx);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.add(line);</span><br><span class="line"></span><br><span class="line">        each(SYMBOL_CATEGORIES, <span class="function"><span class="keyword">function</span> (<span class="params">symbolCategory</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> symbol = createSymbol(symbolCategory, lineData, idx);</span><br><span class="line">            <span class="comment">// symbols must added after line to make sure</span></span><br><span class="line">            <span class="comment">// it will be updated after line#update.</span></span><br><span class="line">            <span class="comment">// Or symbol position and rotation update in line#beforeUpdate will be one frame slow</span></span><br><span class="line">            <span class="keyword">this</span>.add(symbol);</span><br><span class="line">            <span class="keyword">this</span>[makeSymbolTypeKey(symbolCategory)] = lineData.getItemVisual(idx, symbolCategory);</span><br><span class="line">        &#125;, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>._updateCommonStl(lineData, idx, seriesScope);</span><br><span class="line">    &#125;</span><br><span class="line">     updateData(lineData: List, idx: <span class="built_in">number</span>, seriesScope: LineDrawSeriesScope) &#123;</span><br><span class="line">        <span class="keyword">const</span> seriesModel = lineData.hostModel;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> line = <span class="keyword">this</span>.childOfName(<span class="string">'line'</span>) <span class="keyword">as</span> ECLinePath;</span><br><span class="line">        <span class="keyword">const</span> linePoints = lineData.getItemLayout(idx);</span><br><span class="line">        <span class="keyword">const</span> target = &#123;</span><br><span class="line">            shape: &#123;&#125; <span class="keyword">as</span> ECLinePath[<span class="string">'shape'</span>]</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        setLinePoints(target.shape, linePoints);</span><br><span class="line">        graphic.updateProps(line, target, seriesModel, idx);</span><br><span class="line"></span><br><span class="line">        each(SYMBOL_CATEGORIES, <span class="function"><span class="keyword">function</span> (<span class="params">symbolCategory</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> symbolType = (lineData <span class="keyword">as</span> LineList).getItemVisual(idx, symbolCategory);</span><br><span class="line">            <span class="keyword">const</span> key = makeSymbolTypeKey(symbolCategory);</span><br><span class="line">            <span class="comment">// Symbol changed</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">this</span>[key] !== symbolType) &#123;</span><br><span class="line">                <span class="keyword">this</span>.remove(<span class="keyword">this</span>.childOfName(symbolCategory));</span><br><span class="line">                <span class="keyword">const</span> symbol = createSymbol(symbolCategory, lineData <span class="keyword">as</span> LineList, idx);</span><br><span class="line">                <span class="keyword">this</span>.add(symbol);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>[key] = symbolType;</span><br><span class="line">        &#125;, <span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>._updateCommonStl(lineData, idx, seriesScope);</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//部分代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在line类中调用了createLine方法，createLine方法有调用了setLinePoints方法。而原来的setLinePoints方法没有cpx2和cpy2的属性，更改之后如上，percent属性是描述线段显示的百分比。通过lineData是lineList类也是List的子类，通过getItemLayout方法获取数组。也就是setLinePoints的points参数，分别为source，curvepoint1，curvepoint2，target。这样我们就可以通过nodeEgde的setLayout方法来设定边的属性了。</p>
<h3 id="如何计算curvePoints的位置"><a href="#如何计算curvePoints的位置" class="headerlink" title="如何计算curvePoints的位置"></a>如何计算curvePoints的位置</h3><p>这里就需要用到一些简单的数学几何知识，因为LoopEdge的source和target为同一个目标，所以我们只需要确定curvePoint的位置就好了。我们可以取一条过圆心的线，而两个curvePoint所成线段被该线垂直平分，此时所形成的贝塞尔曲线就是我们需要的形状。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCubicControlPoint</span>(<span class="params">radToXPosi: <span class="built_in">number</span>, cpDistToCenter: <span class="built_in">number</span></span>): <span class="title">number</span>[] </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="built_in">Math</span>.cos(radToXPosi) * cpDistToCenter + centerPt[<span class="number">0</span>],</span><br><span class="line">            <span class="built_in">Math</span>.sin(radToXPosi) * cpDistToCenter + centerPt[<span class="number">1</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<p>这里就是直接计算点坐标的公式了，而这里的radToXposi是弧度为单位的，乘上长度变成了坐标。</p>
<p>而当我们的节点与其他节点有其他边的关系时，我们如何选取LoopEdge的中线位置来画边呢？这里是导师给出的思路。</p>
<ol>
<li><p>取该节点的相邻边，并依据边的正切值对边进行排序。 </p>
</li>
<li><p>再一次根据正切值画出每一个 section，并找出最小的 section 部分。如果最小部分 </p>
</li>
</ol>
<p>大于 60°，则放入 sectionlist 内，且将 availableCount 加上在这个部分可以放入的边的数。 </p>
<ol start="3">
<li>如果可以放边的数大于需要放的 Loop 边，则在 section 中找到最大的部分，将边 </li>
</ol>
<p>放入。</p>
<ol start="4">
<li><p>当边太多时，我们则不考虑边的交叠影响。 </p>
</li>
<li><p>放边的算法：在每个 section 中有 edgeCount 属性，如果该属性为 0，则直接跳出， </p>
</li>
</ol>
<p>反之继续；</p>
<ol start="6">
<li>edgeCount 主要把 section 再次细分成几个部分。在计算部分的中线，进行计算剩 </li>
</ol>
<p>下两个点的坐标。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Graph, &#123; GraphEdge, GraphNode &#125; <span class="keyword">from</span> <span class="string">'../../data/Graph'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; sub, VectorArray &#125; <span class="keyword">from</span> <span class="string">'zrender/src/core/vector'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; assert, bind, each, retrieve2 &#125; <span class="keyword">from</span> <span class="string">'zrender/src/core/util'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; GraphEdgeItemOption &#125; <span class="keyword">from</span> <span class="string">'./GraphSeries'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getSymbolSize &#125; <span class="keyword">from</span> <span class="string">'./graphHelper'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Radian = <span class="built_in">number</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> NodeAttrOnEdge = <span class="string">'node1'</span> | <span class="string">'node2'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> EdgeWrap &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Vector of the tangent line at the center node.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    tangentVec: VectorArray;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Radian of tangentVec (to x positive) of tangentVec. [-Math.PI / 2, Math.PI / 2].</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    radToXPosi: Radian;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> SectionWrap &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Radian of tangentVec (to x positive) of tangentVec. [-Math.PI / 2, Math.PI / 2].</span></span><br><span class="line"><span class="comment">     * Make sure radToXPosiStart &lt;= radToXPosiEnd.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    radToXPosiStart: Radian;</span><br><span class="line">    radToXPosiEnd: Radian;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * The count of edges that assign to this section.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    edgeCount: <span class="built_in">number</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> MATH_PI = <span class="built_in">Math</span>.PI;</span><br><span class="line"><span class="keyword">const</span> MATH_2PI = MATH_PI * <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * This is the radian of the intersection angle of the two control</span></span><br><span class="line"><span class="comment"> * point of a self-loop cubic bezier edge.</span></span><br><span class="line"><span class="comment"> * If the angle is bigger or smaller, the cubic curve is not pretty.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">const</span> MAX_EDGE_SECTION_RADIAN = MATH_PI - getRadianToXPositive([<span class="number">4</span>, <span class="number">5.5</span>]) * <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> MIN_EDGE_SECTION_RADIAN = MATH_PI / <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @caution This method should only be called after all</span></span><br><span class="line"><span class="comment"> * nodes and non-self-loop edges layout finished.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @note [Self-loop edge layout strategy]:</span></span><br><span class="line"><span class="comment"> * To make it have good looking when there are muliple self-loop edges,</span></span><br><span class="line"><span class="comment"> * place them from the biggest angle (&gt; 60 degree) one by one.</span></span><br><span class="line"><span class="comment"> * If there is no enough angles, put mulitple edges in one angle</span></span><br><span class="line"><span class="comment"> * and use different curvenesses.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @pending Should the section angle and self-loop edge direction be able to set by user?</span></span><br><span class="line"><span class="comment"> * `curveness` can not express it.</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * @pending Consider the self-loop edge might overlow the canvas.</span></span><br><span class="line"><span class="comment"> * When calculating the view transform, there is no self-loop layout info yet.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">layoutSelfLoopEdges</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    graph: Graph,</span></span></span><br><span class="line"><span class="function"><span class="params">    <span class="comment">// Get from `getNodeGlobalScale(seriesModel)`</span></span></span></span><br><span class="line"><span class="function"><span class="params">    nodeScaleOnCoordSys: <span class="built_in">number</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    graph.eachNode(<span class="function"><span class="params">node</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> selfLoopEdges: GraphEdge[] = [];</span><br><span class="line">        <span class="comment">// inEdges includes outEdges if self-loop.</span></span><br><span class="line">        each(node.inEdges, <span class="function"><span class="params">edge</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (isSelfLoopEdge(edge)) &#123;</span><br><span class="line">                selfLoopEdges.push(edge);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (selfLoopEdges.length) &#123;</span><br><span class="line">            <span class="keyword">const</span> sectionList = prepareSectionList(node, selfLoopEdges.length);</span><br><span class="line">            placeSelfLoopEdges(node, sectionList, selfLoopEdges, nodeScaleOnCoordSys);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @return Sections that can arrange self-loop angles. Ensure that:</span></span><br><span class="line"><span class="comment"> *         `selfLoopEdgeCount &lt;= sectionList.reduce((sum, sec) === sec.edgeCount + sum, 0)`</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">prepareSectionList</span>(<span class="params">centerNode: GraphNode, selfLoopEdgeCount: <span class="built_in">number</span></span>): <span class="title">SectionWrap</span>[] </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> adjacentEdges: EdgeWrap[] = [];</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">addAdjacentEdge</span>(<span class="params">centerNodeAttr: NodeAttrOnEdge, edge: GraphEdge</span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (isSelfLoopEdge(edge)) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> tangentVec = getTangentVector(edge, centerNodeAttr);</span><br><span class="line">        <span class="keyword">const</span> radToXPosi = getRadianToXPositive(tangentVec);</span><br><span class="line">        adjacentEdges.push(&#123; tangentVec, radToXPosi &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    each(centerNode.inEdges, bind(addAdjacentEdge, <span class="literal">null</span>, <span class="string">'node2'</span>));</span><br><span class="line">    each(centerNode.outEdges, bind(addAdjacentEdge, <span class="literal">null</span>, <span class="string">'node1'</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sort by radian asc.</span></span><br><span class="line">    adjacentEdges.sort(<span class="function">(<span class="params">edgeA, edgeB</span>) =&gt;</span> edgeA.radToXPosi - edgeB.radToXPosi);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> availableEdgeCount = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">const</span> sectionList: SectionWrap[] = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>, len = adjacentEdges.length; i &lt; len; i++) &#123;</span><br><span class="line">        <span class="keyword">const</span> radToXPosiStart = adjacentEdges[i].radToXPosi;</span><br><span class="line">        <span class="keyword">const</span> radToXPosiEnd = i &lt; len - <span class="number">1</span></span><br><span class="line">            ? adjacentEdges[i + <span class="number">1</span>].radToXPosi</span><br><span class="line">            : adjacentEdges[<span class="number">0</span>].radToXPosi + MATH_2PI;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Make sure radToXPosiStart &lt;= radToXPosiEnd.</span></span><br><span class="line">        <span class="keyword">const</span> rad2Minus1 = radToXPosiEnd - radToXPosiStart;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (rad2Minus1 &gt;= MIN_EDGE_SECTION_RADIAN) &#123;</span><br><span class="line">            sectionList.push(&#123; radToXPosiStart, radToXPosiEnd, edgeCount: <span class="number">0</span> &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        availableEdgeCount += rad2Minus1 / MIN_EDGE_SECTION_RADIAN;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (availableEdgeCount &gt;= selfLoopEdgeCount) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> iEdge = <span class="number">0</span>; iEdge &lt; selfLoopEdgeCount; iEdge++) &#123;</span><br><span class="line">            <span class="comment">// Find the largest section to arrange an edge.</span></span><br><span class="line">            <span class="keyword">let</span> iSecInMax = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">let</span> secRadInMax = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">let</span> iSec = <span class="number">0</span>; iSec &lt; sectionList.length; iSec++) &#123;</span><br><span class="line">                <span class="keyword">const</span> thisSec = sectionList[iSec];</span><br><span class="line">                <span class="comment">// If a section is too larger than anohter section, split that large section and</span></span><br><span class="line">                <span class="comment">// arrange multiple edges in it is probably better then arrange only one edge in</span></span><br><span class="line">                <span class="comment">// the large section.</span></span><br><span class="line">                <span class="keyword">const</span> rad = (thisSec.radToXPosiEnd - thisSec.radToXPosiStart) / (thisSec.edgeCount + <span class="number">1</span>);</span><br><span class="line">                <span class="keyword">if</span> (rad &gt; secRadInMax) &#123;</span><br><span class="line">                    secRadInMax = rad;</span><br><span class="line">                    iSecInMax = iSec;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sectionList[iSecInMax].edgeCount++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// In this case there are probably too many edge on a node, and intersection between</span></span><br><span class="line">    <span class="comment">// edges can not avoid. So we do not care about intersection any more.</span></span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        sectionList.length = <span class="number">0</span>;</span><br><span class="line">        sectionList.push(&#123;</span><br><span class="line">            radToXPosiStart: -MATH_PI / <span class="number">2</span>,</span><br><span class="line">            radToXPosiEnd: -MATH_PI / <span class="number">2</span> + MATH_2PI,</span><br><span class="line">            edgeCount: selfLoopEdgeCount</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sectionList;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @return cubic bezier curve: [p1, p2, cp1, cp2]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">placeSelfLoopEdges</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    centerNode: GraphNode,</span></span></span><br><span class="line"><span class="function"><span class="params">    sectionList: SectionWrap[],</span></span></span><br><span class="line"><span class="function"><span class="params">    selfLoopEdges: GraphEdge[],</span></span></span><br><span class="line"><span class="function"><span class="params">    nodeScaleOnCoordSys: <span class="built_in">number</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>): <span class="title">void</span> </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> symbolSize = getSymbolSize(centerNode);</span><br><span class="line">    <span class="keyword">const</span> centerPt = centerNode.getLayout();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getCubicControlPoint</span>(<span class="params">radToXPosi: <span class="built_in">number</span>, cpDistToCenter: <span class="built_in">number</span></span>): <span class="title">number</span>[] </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [</span><br><span class="line">            <span class="built_in">Math</span>.cos(radToXPosi) * cpDistToCenter + centerPt[<span class="number">0</span>],</span><br><span class="line">            <span class="built_in">Math</span>.sin(radToXPosi) * cpDistToCenter + centerPt[<span class="number">1</span>]</span><br><span class="line">        ];</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> iEdge = <span class="number">0</span>;</span><br><span class="line">    each(sectionList, <span class="function"><span class="params">section</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> secEdgeCount = section.edgeCount;</span><br><span class="line">        <span class="keyword">if</span> (!secEdgeCount) &#123;</span><br><span class="line">            <span class="comment">// No self-loop edge arranged in this section.</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> secRadStart = section.radToXPosiStart;</span><br><span class="line">        <span class="keyword">const</span> secRadEnd = section.radToXPosiEnd;</span><br><span class="line">        <span class="keyword">const</span> splitRadHalfSpan = (secRadEnd - secRadStart) / section.edgeCount / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">const</span> edgeRadHalfSpan = <span class="built_in">Math</span>.min(splitRadHalfSpan, MAX_EDGE_SECTION_RADIAN / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// const radMid = secRadStart + secRadSpan / section.edgeCount * (iEdge - iEdgeFirstInSec);</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> iEdgeInSec = <span class="number">0</span>; iEdgeInSec &lt; section.edgeCount; iEdgeInSec++) &#123;</span><br><span class="line">            <span class="keyword">const</span> edge = selfLoopEdges[iEdge++];</span><br><span class="line">            <span class="keyword">const</span> cpMidRad = secRadStart + splitRadHalfSpan * (iEdgeInSec * <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// This is a experimental strategy to make it look better:</span></span><br><span class="line">            <span class="comment">// If the symbol size is small, the bezier control point need to be far from the</span></span><br><span class="line">            <span class="comment">// center to make the buckle obvious, while if the symbol size is big, the control</span></span><br><span class="line">            <span class="comment">// ponit should not too far to make the buckle too significant.</span></span><br><span class="line">            <span class="comment">// So we alway make control point dist to symbol radius `100`, and enable users to</span></span><br><span class="line">            <span class="comment">// use option `curveness` to adjust it.</span></span><br><span class="line">            <span class="comment">// Becuase at present we do not layout multiple self-loop edges into single</span></span><br><span class="line">            <span class="comment">// `[cp1Rad, cp2Rad]`, we do not use option `autoCurveness`.</span></span><br><span class="line">            <span class="keyword">const</span> curveness = retrieve2(</span><br><span class="line">                edge.getModel&lt;GraphEdgeItemOption&gt;().get([<span class="string">'lineStyle'</span>, <span class="string">'curveness'</span>]),</span><br><span class="line">                <span class="number">0</span></span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">const</span> cpDistToCenter = (symbolSize / <span class="number">2</span> + <span class="number">100</span>) * nodeScaleOnCoordSys</span><br><span class="line">                * (curveness + <span class="number">1</span>)</span><br><span class="line">                <span class="comment">// Formula:</span></span><br><span class="line">                <span class="comment">// If `cpDistToCenter = symbolSize / 2 * nodeScaleOnCoordSys / 3 * 4 / Math.cos(edgeRadHalfSpan)`,</span></span><br><span class="line">                <span class="comment">// the control point can be tangent to the symbol circle.</span></span><br><span class="line">                <span class="comment">// Hint: `distCubicMiddlePtToCenterPt / 3 * 4` get the hight of the isosceles triangle made by</span></span><br><span class="line">                <span class="comment">// control points and center point.</span></span><br><span class="line">                / <span class="number">3</span> * <span class="number">4</span> / <span class="built_in">Math</span>.cos(edgeRadHalfSpan);</span><br><span class="line"></span><br><span class="line">            edge.setLayout([</span><br><span class="line">                centerPt.slice(),</span><br><span class="line">                centerPt.slice(),</span><br><span class="line">                getCubicControlPoint(cpMidRad - edgeRadHalfSpan, cpDistToCenter),</span><br><span class="line">                getCubicControlPoint(cpMidRad + edgeRadHalfSpan, cpDistToCenter)</span><br><span class="line">            ]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    assert(iEdge === selfLoopEdges.length);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @return vector representing the tangant line</span></span><br><span class="line"><span class="comment"> *         (from edge['node1' | 'node2'] to cp1 of the cubic bezier curve)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTangentVector</span>(<span class="params">edge: GraphEdge, nodeAttr: NodeAttrOnEdge</span>): <span class="title">VectorArray</span> </span>&#123;</span><br><span class="line">    <span class="comment">// points is [p1, p2] or [p1, p2, cp1].</span></span><br><span class="line">    <span class="keyword">const</span> points = edge.getLayout();</span><br><span class="line">    <span class="keyword">const</span> targetPt = points[<span class="number">2</span>] ? points[<span class="number">2</span>] : points[<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">return</span> sub([], targetPt, edge[nodeAttr].getLayout());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getRadianToXPositive</span>(<span class="params">vec: VectorArray</span>): <span class="title">Radian</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.atan2(vec[<span class="number">1</span>], vec[<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">isSelfLoopEdge</span>(<span class="params">edge: GraphEdge</span>): <span class="title">boolean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> edge.node1 === edge.node2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="AjustEgde"><a href="#AjustEgde" class="headerlink" title="AjustEgde"></a>AjustEgde</h3><p>在原本的需求里面还有一个adjustEgde的对于边的渲染的改变，使得symbol的坐标在节点边上而不是圆心。这里的算法思路就是利用二分法找到在线段上和节点最近的点。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> curveTool <span class="keyword">from</span> <span class="string">'zrender/src/core/curve'</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> vec2 <span class="keyword">from</span> <span class="string">'zrender/src/core/vector'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;getSymbolSize&#125; <span class="keyword">from</span> <span class="string">'./graphHelper'</span>;</span><br><span class="line"><span class="keyword">import</span> Graph <span class="keyword">from</span> <span class="string">'../../data/Graph'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> v1: <span class="built_in">number</span>[] = [];</span><br><span class="line"><span class="keyword">const</span> v2: <span class="built_in">number</span>[] = [];</span><br><span class="line"><span class="keyword">const</span> v3: <span class="built_in">number</span>[] = [];</span><br><span class="line"><span class="keyword">const</span> quadraticAt = curveTool.quadraticAt;</span><br><span class="line"><span class="keyword">const</span> cubicAt = curveTool.cubicAt;</span><br><span class="line"><span class="keyword">const</span> v2DistSquare = vec2.distSquare;</span><br><span class="line"><span class="keyword">const</span> mathAbs = <span class="built_in">Math</span>.abs;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">intersectCurveCircle</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    curvePoints: <span class="built_in">number</span>[][],</span></span></span><br><span class="line"><span class="function"><span class="params">    center: <span class="built_in">number</span>[],</span></span></span><br><span class="line"><span class="function"><span class="params">    radius: <span class="built_in">number</span></span></span></span><br><span class="line"><span class="function"><span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> p0 = curvePoints[<span class="number">0</span>]; <span class="comment">// source point</span></span><br><span class="line">    <span class="keyword">const</span> p1 = curvePoints[<span class="number">1</span>]; <span class="comment">// curve point 1 </span></span><br><span class="line">    <span class="keyword">const</span> p2 = curvePoints[<span class="number">2</span>]; <span class="comment">// curve point 2 or target point</span></span><br><span class="line">    <span class="keyword">const</span> p3 = curvePoints[<span class="number">3</span>] ?? [<span class="literal">null</span>, <span class="literal">null</span>]; <span class="comment">// target point</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> d = <span class="literal">Infinity</span>;</span><br><span class="line">    <span class="keyword">let</span> t;</span><br><span class="line">    <span class="keyword">const</span> radiusSquare = radius * radius;</span><br><span class="line">    <span class="keyword">let</span> interval = <span class="number">0.1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> bezierAt = p3[<span class="number">0</span>] &amp;&amp; p3[<span class="number">1</span>]</span><br><span class="line">        ? cubicAt <span class="comment">// 计算三次贝塞尔值</span></span><br><span class="line">        : <span class="function"><span class="keyword">function</span> (<span class="params">p0: <span class="built_in">number</span>, p1: <span class="built_in">number</span>, p2: <span class="built_in">number</span>, p3: <span class="built_in">number</span>, t: <span class="built_in">number</span></span>): <span class="title">number</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> quadraticAt(p0, p1, p2, t); <span class="comment">//计算二次贝塞尔值</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> _t = <span class="number">0.1</span>; _t &lt;= <span class="number">0.9</span>; _t += <span class="number">0.1</span>) &#123;</span><br><span class="line">        v1[<span class="number">0</span>] = bezierAt(p0[<span class="number">0</span>], p1[<span class="number">0</span>], p2[<span class="number">0</span>], p3[<span class="number">0</span>], _t); <span class="comment">//bezire curve point of x</span></span><br><span class="line">        v1[<span class="number">1</span>] = bezierAt(p0[<span class="number">1</span>], p1[<span class="number">1</span>], p2[<span class="number">1</span>], p3[<span class="number">1</span>], _t); <span class="comment">//bezire curve point of y</span></span><br><span class="line">        <span class="keyword">const</span> diff = mathAbs(v2DistSquare(v1, center) - radiusSquare);</span><br><span class="line">        <span class="keyword">if</span> (diff &lt; d) &#123;</span><br><span class="line">            d = diff;</span><br><span class="line">            t = _t;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Assume the segment is monotone，Find root through Bisection method</span></span><br><span class="line">    <span class="comment">// At most 32 iteration</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">        <span class="comment">// const prev = t - interval;</span></span><br><span class="line">        <span class="keyword">const</span> next = t + interval;</span><br><span class="line">        <span class="comment">// v1[0] = bezierAt(p0[0], p1[0], p2[0], p3[0], prev);</span></span><br><span class="line">        <span class="comment">// v1[1] = bezierAt(p0[1], p1[1], p2[1], p3[1], prev);</span></span><br><span class="line">        v2[<span class="number">0</span>] = bezierAt(p0[<span class="number">0</span>], p1[<span class="number">0</span>], p2[<span class="number">0</span>], p3[<span class="number">0</span>], t);</span><br><span class="line">        v2[<span class="number">1</span>] = bezierAt(p0[<span class="number">1</span>], p1[<span class="number">1</span>], p2[<span class="number">1</span>], p3[<span class="number">1</span>], t);</span><br><span class="line">        v3[<span class="number">0</span>] = bezierAt(p0[<span class="number">0</span>], p1[<span class="number">0</span>], p2[<span class="number">0</span>], p3[<span class="number">0</span>], next);</span><br><span class="line">        v3[<span class="number">1</span>] = bezierAt(p0[<span class="number">1</span>], p1[<span class="number">1</span>], p2[<span class="number">1</span>], p3[<span class="number">1</span>], next);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> diff = v2DistSquare(v2, center) - radiusSquare;</span><br><span class="line">        <span class="keyword">if</span> (mathAbs(diff) &lt; <span class="number">1e-2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// let prevDiff = v2DistSquare(v1, center) - radiusSquare;</span></span><br><span class="line">        <span class="keyword">const</span> nextDiff = v2DistSquare(v3, center) - radiusSquare;</span><br><span class="line"></span><br><span class="line">        interval /= <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (diff &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nextDiff &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    t = t + interval;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    t = t - interval;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> (nextDiff &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    t = t - interval;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    t = t + interval;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Adjust edge to avoid</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">adjustEdge</span>(<span class="params">graph: Graph, scale: <span class="built_in">number</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> tmp0: <span class="built_in">number</span>[] = [];</span><br><span class="line">    <span class="keyword">const</span> quadraticSubdivide = curveTool.quadraticSubdivide; <span class="comment">//细分二次贝塞尔曲线</span></span><br><span class="line">    <span class="keyword">const</span> cubicSubdivide = curveTool.cubicSubdivide; <span class="comment">//细分三次贝塞尔曲线</span></span><br><span class="line">    <span class="keyword">const</span> pts3: <span class="built_in">number</span>[][] = [[], [], []];</span><br><span class="line">    <span class="keyword">const</span> pts2: <span class="built_in">number</span>[][] = [[], []];</span><br><span class="line">    <span class="keyword">const</span> pts4 : <span class="built_in">number</span>[][] = [[], [], [], []];</span><br><span class="line">    <span class="keyword">const</span> v: <span class="built_in">number</span>[] = [];</span><br><span class="line">    scale /= <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    graph.eachEdge(<span class="function"><span class="keyword">function</span> (<span class="params">edge, idx</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">const</span> linePoints = edge.getLayout();</span><br><span class="line">        <span class="keyword">const</span> fromSymbol = edge.getVisual(<span class="string">'fromSymbol'</span>);</span><br><span class="line">        <span class="keyword">const</span> toSymbol = edge.getVisual(<span class="string">'toSymbol'</span>);</span><br><span class="line">        <span class="keyword">if</span> (!linePoints.__original) &#123;</span><br><span class="line">            linePoints.__original = [</span><br><span class="line">                vec2.clone(linePoints[<span class="number">0</span>]),</span><br><span class="line">                vec2.clone(linePoints[<span class="number">1</span>])</span><br><span class="line">            ];</span><br><span class="line">            <span class="keyword">if</span> (linePoints[<span class="number">2</span>]) &#123;</span><br><span class="line">                linePoints.__original.push(vec2.clone(linePoints[<span class="number">2</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (linePoints[<span class="number">3</span>]) &#123;</span><br><span class="line">                linePoints.__original.push(vec2.clone(linePoints[<span class="number">3</span>]));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">const</span> originalPoints = linePoints.__original;</span><br><span class="line">        <span class="comment">// Cubic curve</span></span><br><span class="line">        <span class="keyword">if</span> (linePoints[<span class="number">3</span>] != <span class="literal">null</span>) &#123;</span><br><span class="line">            vec2.copy(pts4[<span class="number">0</span>], originalPoints[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(pts4[<span class="number">1</span>], originalPoints[<span class="number">2</span>]);</span><br><span class="line">            vec2.copy(pts4[<span class="number">2</span>], originalPoints[<span class="number">3</span>]);</span><br><span class="line">            vec2.copy(pts4[<span class="number">3</span>], originalPoints[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (fromSymbol &amp;&amp; fromSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node1);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> t = intersectCurveCircle(pts4, originalPoints[<span class="number">0</span>], symbolSize * scale);</span><br><span class="line">                <span class="keyword">if</span> (t &gt; <span class="number">0.5</span>) &#123;</span><br><span class="line">                    t = <span class="number">1</span> - t;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// Subdivide and get the second</span></span><br><span class="line">                cubicSubdivide(pts4[<span class="number">0</span>][<span class="number">0</span>], pts4[<span class="number">1</span>][<span class="number">0</span>], pts4[<span class="number">2</span>][<span class="number">0</span>], pts4[<span class="number">3</span>][<span class="number">0</span>], t, tmp0);</span><br><span class="line">                pts4[<span class="number">0</span>][<span class="number">0</span>] = tmp0[<span class="number">4</span>];</span><br><span class="line">                pts4[<span class="number">1</span>][<span class="number">0</span>] = tmp0[<span class="number">5</span>];</span><br><span class="line">                pts4[<span class="number">2</span>][<span class="number">0</span>] = tmp0[<span class="number">6</span>];</span><br><span class="line">                cubicSubdivide(pts4[<span class="number">0</span>][<span class="number">1</span>], pts4[<span class="number">1</span>][<span class="number">1</span>], pts4[<span class="number">2</span>][<span class="number">1</span>], pts4[<span class="number">3</span>][<span class="number">1</span>], t, tmp0);</span><br><span class="line">                pts4[<span class="number">0</span>][<span class="number">1</span>] = tmp0[<span class="number">4</span>];</span><br><span class="line">                pts4[<span class="number">1</span>][<span class="number">1</span>] = tmp0[<span class="number">5</span>];</span><br><span class="line">                pts4[<span class="number">2</span>][<span class="number">1</span>] = tmp0[<span class="number">6</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (toSymbol &amp;&amp; toSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node2);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> t = intersectCurveCircle(pts4, originalPoints[<span class="number">1</span>], symbolSize * scale);</span><br><span class="line">                <span class="keyword">if</span> (t &lt; <span class="number">0.5</span>) &#123;</span><br><span class="line">                    t = <span class="number">1</span> - t;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// Subdivide and get the first</span></span><br><span class="line">                cubicSubdivide(pts4[<span class="number">0</span>][<span class="number">0</span>], pts4[<span class="number">1</span>][<span class="number">0</span>], pts4[<span class="number">2</span>][<span class="number">0</span>], pts4[<span class="number">3</span>][<span class="number">0</span>], t, tmp0);</span><br><span class="line">                pts4[<span class="number">1</span>][<span class="number">0</span>] = tmp0[<span class="number">1</span>];</span><br><span class="line">                pts4[<span class="number">2</span>][<span class="number">0</span>] = tmp0[<span class="number">2</span>];</span><br><span class="line">                pts4[<span class="number">3</span>][<span class="number">0</span>] = tmp0[<span class="number">3</span>];</span><br><span class="line">                cubicSubdivide(pts4[<span class="number">0</span>][<span class="number">1</span>], pts4[<span class="number">1</span>][<span class="number">1</span>], pts4[<span class="number">2</span>][<span class="number">1</span>], pts4[<span class="number">3</span>][<span class="number">1</span>], t, tmp0);</span><br><span class="line">                pts4[<span class="number">1</span>][<span class="number">1</span>] = tmp0[<span class="number">1</span>];</span><br><span class="line">                pts4[<span class="number">2</span>][<span class="number">1</span>] = tmp0[<span class="number">2</span>];</span><br><span class="line">                pts4[<span class="number">3</span>][<span class="number">1</span>] = tmp0[<span class="number">3</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            vec2.copy(linePoints[<span class="number">0</span>], pts4[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">1</span>], pts4[<span class="number">3</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">2</span>], pts4[<span class="number">1</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">3</span>], pts4[<span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Quadratic curve</span></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (linePoints[<span class="number">2</span>] != <span class="literal">null</span>) &#123;</span><br><span class="line">            vec2.copy(pts3[<span class="number">0</span>], originalPoints[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(pts3[<span class="number">1</span>], originalPoints[<span class="number">2</span>]);</span><br><span class="line">            vec2.copy(pts3[<span class="number">2</span>], originalPoints[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">if</span> (fromSymbol &amp;&amp; fromSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node1);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> t = intersectCurveCircle(pts3, originalPoints[<span class="number">0</span>], symbolSize * scale);</span><br><span class="line">                <span class="comment">// Subdivide and get the second</span></span><br><span class="line">                quadraticSubdivide(pts3[<span class="number">0</span>][<span class="number">0</span>], pts3[<span class="number">1</span>][<span class="number">0</span>], pts3[<span class="number">2</span>][<span class="number">0</span>], t, tmp0);</span><br><span class="line">                pts3[<span class="number">0</span>][<span class="number">0</span>] = tmp0[<span class="number">3</span>];</span><br><span class="line">                pts3[<span class="number">1</span>][<span class="number">0</span>] = tmp0[<span class="number">4</span>];</span><br><span class="line">                quadraticSubdivide(pts3[<span class="number">0</span>][<span class="number">1</span>], pts3[<span class="number">1</span>][<span class="number">1</span>], pts3[<span class="number">2</span>][<span class="number">1</span>], t, tmp0);</span><br><span class="line">                pts3[<span class="number">0</span>][<span class="number">1</span>] = tmp0[<span class="number">3</span>];</span><br><span class="line">                pts3[<span class="number">1</span>][<span class="number">1</span>] = tmp0[<span class="number">4</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (toSymbol &amp;&amp; toSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node2);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> t = intersectCurveCircle(pts3, originalPoints[<span class="number">1</span>], symbolSize * scale);</span><br><span class="line">                <span class="comment">// Subdivide and get the first</span></span><br><span class="line">                quadraticSubdivide(pts3[<span class="number">0</span>][<span class="number">0</span>], pts3[<span class="number">1</span>][<span class="number">0</span>], pts3[<span class="number">2</span>][<span class="number">0</span>], t, tmp0);</span><br><span class="line">                pts3[<span class="number">1</span>][<span class="number">0</span>] = tmp0[<span class="number">1</span>];</span><br><span class="line">                pts3[<span class="number">2</span>][<span class="number">0</span>] = tmp0[<span class="number">2</span>];</span><br><span class="line">                quadraticSubdivide(pts3[<span class="number">0</span>][<span class="number">1</span>], pts3[<span class="number">1</span>][<span class="number">1</span>], pts3[<span class="number">2</span>][<span class="number">1</span>], t, tmp0);</span><br><span class="line">                pts3[<span class="number">1</span>][<span class="number">1</span>] = tmp0[<span class="number">1</span>];</span><br><span class="line">                pts3[<span class="number">2</span>][<span class="number">1</span>] = tmp0[<span class="number">2</span>];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// Copy back to layout</span></span><br><span class="line">            vec2.copy(linePoints[<span class="number">0</span>], pts3[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">1</span>], pts3[<span class="number">2</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">2</span>], pts3[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// Line</span></span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            vec2.copy(pts2[<span class="number">0</span>], originalPoints[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(pts2[<span class="number">1</span>], originalPoints[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">            vec2.sub(v, pts2[<span class="number">1</span>], pts2[<span class="number">0</span>]);</span><br><span class="line">            vec2.normalize(v, v);</span><br><span class="line">            <span class="keyword">if</span> (fromSymbol &amp;&amp; fromSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node1);</span><br><span class="line"></span><br><span class="line">                vec2.scaleAndAdd(pts2[<span class="number">0</span>], pts2[<span class="number">0</span>], v, symbolSize * scale);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (toSymbol &amp;&amp; toSymbol !== <span class="string">'none'</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> symbolSize = getSymbolSize(edge.node2);</span><br><span class="line"></span><br><span class="line">                vec2.scaleAndAdd(pts2[<span class="number">1</span>], pts2[<span class="number">1</span>], v, -symbolSize * scale);</span><br><span class="line">            &#125;</span><br><span class="line">            vec2.copy(linePoints[<span class="number">0</span>], pts2[<span class="number">0</span>]);</span><br><span class="line">            vec2.copy(linePoints[<span class="number">1</span>], pts2[<span class="number">1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/Sass/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/Sass/" class="post-title-link" itemprop="url">Sass</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:41:04" itemprop="dateCreated datePublished" datetime="2021-09-22T10:41:04+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-02 14:25:38" itemprop="dateModified" datetime="2020-04-02T14:25:38+08:00">2020-04-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Sass学习"><a href="#Sass学习" class="headerlink" title="Sass学习"></a>Sass学习</h1><p>​        因为在Taro项目中有用到Sass，但是当时并没有学习所以就分开来写。</p>
<h3 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h3><p>因为Taro项目初始化的时候会自行安装，只要选择Sass就行了。所以这里给出官方链接。<a href="https://sass.bootcss.com/install" target="_blank" rel="noopener">https://sass.bootcss.com/install</a></p>
<h3 id="二、变量"><a href="#二、变量" class="headerlink" title="二、变量"></a>二、变量</h3><p>变量是存储信息并在将来重复利用的一种方式，在整个样式表中都可访问。 你可以在变量中存储颜色、字体 或任何 CSS 值，并在将来重复利用。Sass 使用 <code>$</code> 符号 作为变量的标志。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$font-stack</span>:    Helvetica, sans-serif;</span><br><span class="line"><span class="variable">$primary-color</span>: <span class="number">#333</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">100%</span> <span class="variable">$font-stack</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$primary-color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">100%</span> Helvetica, sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="三、嵌套"><a href="#三、嵌套" class="headerlink" title="三、嵌套"></a>三、嵌套</h3><p>​        在编写 HTML 时，它有一个清晰的嵌套和可视化层次结构。 而 CSS 则没有。</p>
<p>​        Sass 允许嵌套 CSS 选择器，嵌套方式 与 HTML 的视觉层次结构相同。请注意，过度嵌套的规则 将导致过度限定的 CSS，这些 CSS 可能很难维护，并且 通常被认为是不好的做法。</p>
<p>​        理解了这一点，下面就来看一个典型的网站导航的样式 示例：</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> &#123;</span><br><span class="line">  <span class="selector-tag">ul</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">li</span> &#123; <span class="attribute">display</span>: inline-block; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">ul</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">li</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">nav</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">6px</span> <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="四、片段"><a href="#四、片段" class="headerlink" title="四、片段"></a>四、片段</h3><p>创建部分Sass文件，其中包含一些CSS片段 ，可以将其包含在其他Sass文件中。这是模块化CSS并帮助使事情易于维护的好方法。部分文件是一个Sass文件，名称前带有一个下划线。可以将其命名为<code>_partial.scss</code>。下划线让Sass知道该文件只是部分文件，不应将其生成为CSS文件。Sass局部函数与<code>@use</code> 规则一起使用。</p>
<h3 id="五、模块"><a href="#五、模块" class="headerlink" title="五、模块"></a>五、模块</h3><p>不必将所有Sass都写在一个文件中。您可以根据需要将其拆分<code>@use</code>。该规则将另一个Sass文件作为<em>模块</em>加载，这意味着您可以在Sass文件中使用基于文件名的命名空间引用其变量，<a href="https://sass-lang.com/guide#topic-6" target="_blank" rel="noopener">mixins</a>和<a href="https://sass-lang.com/documentation/at-rules/function" target="_blank" rel="noopener">函数</a>。使用文件还将在编译输出中包含它生成的CSS！</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// _base.scss</span></span><br><span class="line"><span class="variable">$font-stack</span>:    Helvetica, sans-serif;</span><br><span class="line"><span class="variable">$primary-color</span>: <span class="number">#333</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">100%</span> <span class="variable">$font-stack</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="variable">$primary-color</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// styles.scss</span></span><br><span class="line">@use <span class="string">'base'</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inverse</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: base.<span class="variable">$primary-color</span>;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">font</span>: <span class="number">100%</span> Helvetica, sans-serif;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.inverse</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="六、混合"><a href="#六、混合" class="headerlink" title="六、混合"></a>六、混合</h3><p>​        CSS中的某些内容编写起来有些繁琐，尤其是使用CSS3 和存在的许多供应商前缀时。使用mixin，您可以创建要在整个站点中重复使用的CSS声明组 。您甚至可以传入值以使混入更加灵活。mixin的一个很好的用法是用于供应商前缀。这是的示例 <code>transform</code>。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">mixin</span> transform(<span class="variable">$property</span>) &#123;</span><br><span class="line">  -webkit-<span class="attribute">transform</span>: <span class="variable">$property</span>;</span><br><span class="line">  -ms-<span class="attribute">transform</span>: <span class="variable">$property</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="variable">$property</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> &#123; @<span class="keyword">include</span> transform(rotate(<span class="number">30deg</span>)); &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(30deg);</span><br><span class="line">  <span class="attribute">-ms-transform</span>: <span class="built_in">rotate</span>(30deg);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(30deg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>要创建一个mixin，请使用<code>@mixin</code>指令并为其命名。我们将其命名为mixin <code>transform</code>。我们还在<code>$property</code>括号内使用了变量 ，因此我们可以传递任何所需的变换。创建混入之后，您可以将其用作CSS 声明<code>@include</code>，以混入的名称开头。</p>
<h3 id="七、扩展继承"><a href="#七、扩展继承" class="headerlink" title="七、扩展继承"></a>七、扩展继承</h3><p>​        这是Sass最有用的功能之一。使用<code>@extend</code>使您可以将一组CSS属性从一个选择器共享到另一个选择器。它有助于使Sass保持非常干燥。在我们的示例中，我们将使用扩展，占位符类一起使用的另一个功能，为错误，警告和成功创建一系列简单的消息传递。占位符类是一种特殊的类，仅在扩展时才打印，并且可以帮助保持编译后的CSS整洁。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This CSS will print because %message-shared is extended. */</span></span><br><span class="line">%message-shared &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This CSS won't print because %equal-heights is never extended.</span></span><br><span class="line">%equal-heights &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.message</span> &#123;</span><br><span class="line">  @<span class="keyword">extend</span> %message-shared;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.success</span> &#123;</span><br><span class="line">  @<span class="keyword">extend</span> %message-shared;</span><br><span class="line">  <span class="attribute">border-color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.error</span> &#123;</span><br><span class="line">  @<span class="keyword">extend</span> %message-shared;</span><br><span class="line">  <span class="attribute">border-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  @<span class="keyword">extend</span> %message-shared;</span><br><span class="line">  <span class="attribute">border-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* This CSS will print because %message-shared is extended. */</span></span><br><span class="line"><span class="selector-class">.message</span>, <span class="selector-class">.success</span>, <span class="selector-class">.error</span>, <span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.success</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: green;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.error</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.warning</span> &#123;</span><br><span class="line">  <span class="attribute">border-color</span>: yellow;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        上面的代码的作用是告诉<code>.message</code>，<code>.success</code>，<code>.error</code>，和<code>.warning</code>做人一样<code>%message-shared</code>。这意味着任何地方<code>%message-shared</code>显示来，<code>.message</code>，<code>.success</code>，<code>.error</code>，和 <code>.warning</code>也会这样做的。魔术发生在生成的CSS中，其中每个类将获得与相同的CSS属性<code>%message-shared</code>。这有助于您避免在HTML 元素上编写多个类名。</p>
<p>​        除了Sass中的占位符类之外，您还可以扩展最简单的CSS选择器，但是使用占位符是确保不扩展嵌套在样式中其他位置的类的最简单方法，这会导致CSS中意外的选择器 。</p>
<p>​        请注意，不会生成CSS in <code>%equal-heights</code>，因为<code>%equal-heights</code>它不会被扩展。</p>
<h3 id="八、操作符"><a href="#八、操作符" class="headerlink" title="八、操作符"></a>八、操作符</h3><p>​        在 CSS 中经常需要做数学计算。Sass 支持一些标准的 数学运算符，例如 <code>+</code>、<code>-</code>、<code>*</code>、<code>/</code> 和 <code>%</code>。在下面的例子中，我们 将做一些简单的数学运算来计算出 <code>aside</code> &amp; <code>article</code> 的宽度。</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">article</span><span class="selector-attr">[role="main"]</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">600px</span> / <span class="number">960px</span> * <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">aside</span><span class="selector-attr">[role="complementary"]</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">300px</span> / <span class="number">960px</span> * <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/React%20UI%E5%A8%93%E5%8F%89%E7%85%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/React%20UI%E5%A8%93%E5%8F%89%E7%85%8B/" class="post-title-link" itemprop="url">React UI娓叉煋</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:58" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:58+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-27 20:46:22" itemprop="dateModified" datetime="2021-04-27T20:46:22+08:00">2021-04-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​        一开始是因为老板给发的useEffect的链接去看到里面还有一篇关于React渲染机制的，因为老是看到菁程里面渲染次数问题一直没搞清楚，所以就又去看了一下，下面也会写一篇关于useEffect（其实不是特别想写因为怕是直接抄了，还是要想一下怎么用自己的理解写一篇分享吧）</p>
<h2 id="一个小Demo"><a href="#一个小Demo" class="headerlink" title="一个小Demo"></a>一个小Demo</h2><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">title</span>=<span class="string">"ele"</span>&gt;</span>This is an element.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>);</span><br><span class="line"></span><br><span class="line">ReactDOM.render(element, container);</span><br></pre></td></tr></table></figure>

<p>这里<code>element</code>是一个简单的<code>div</code>块,是一个<code>react</code>元素。这里区分一下DOM节点和<code>react</code>元素。<code>container</code>是获取到的DOM节点作为容器。而这里使用的还是<code>JSX</code>语法，<code>Babel</code>会将编译一下变成：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = React.createElement(</span><br><span class="line">	<span class="string">"div"</span>,</span><br><span class="line">    &#123; <span class="attr">title</span>: <span class="string">"ele"</span> &#125;,</span><br><span class="line">    <span class="string">"This is an element"</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">const</span> container = <span class="built_in">document</span>.getElementById(<span class="string">"root"</span>);</span><br><span class="line"></span><br><span class="line">ReactDOM.render(element, container);</span><br></pre></td></tr></table></figure>

<p><code>createElement</code>接受的第一个参数是元素类型<code>div</code>；第二的参数是<code>attribute</code>对象，有<code>title</code>等属性；第三个参数是<code>textNode</code>。</p>
<p>而事实上的一个<code>react</code>元素是这样审的：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = &#123;</span><br><span class="line">    type: <span class="string">"div"</span>,</span><br><span class="line">    props: &#123;</span><br><span class="line">        title: <span class="string">"ele"</span>,</span><br><span class="line">        children: <span class="string">"This is an element"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而在渲染时，发生了以下的传统DOM操作：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 ReactDOM 渲染器内部（简化版）</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createHostInstance</span>(<span class="params">reactElement</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> domNode = <span class="built_in">document</span>.createElement(reactElement.type);  </span><br><span class="line">  domNode.className = reactElement.props.className;  </span><br><span class="line">  <span class="keyword">let</span> textNode =  <span class="built_in">document</span>.createTextNode(<span class="string">""</span>)；</span><br><span class="line">  textNode.nodeValue = reactElement.props.children;</span><br><span class="line">  domNode.appendChild(textNode);</span><br><span class="line">  <span class="keyword">return</span> domNode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>从而将react元素变成了dom的节点。</p>
<p>这里很明显就出现了一个问题，如何处理<code>children</code>是需要优化的。因为<code>children</code>也有可能是一个数组对象（其他的react元素）。</p>
<p>例如这样的一个<code>element</code>：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = (</span><br><span class="line">	&lt;div id=<span class="string">"foo"</span>&gt;</span><br><span class="line">    &lt;a&gt;bar&lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">    &lt;b /</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">)</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/经过编译后</span></span><br><span class="line"><span class="regexp">const element = React.createElement(</span></span><br><span class="line"><span class="regexp">  "div",</span></span><br><span class="line"><span class="regexp">  &#123; id: "foo" &#125;,</span></span><br><span class="line"><span class="regexp">  React.createElement("a", null, "bar"),</span></span><br><span class="line"><span class="regexp">  React.createElement("b")</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure>

<p>我们开始工厂模式创造元素：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createElement</span>(<span class="params">type, props, ...children</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    type,</span><br><span class="line">    props: &#123;</span><br><span class="line">      ...props,</span><br><span class="line">      children: children.map(<span class="function"><span class="params">child</span> =&gt;</span></span><br><span class="line">        <span class="keyword">typeof</span> child === <span class="string">"object"</span></span><br><span class="line">          ? child</span><br><span class="line">          : createTextElement(child)</span><br><span class="line">      ),</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTextElement</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    type: <span class="string">"TEXT_ELEMENT"</span>,</span><br><span class="line">    props: &#123;</span><br><span class="line">      nodeValue: text,</span><br><span class="line">      children: [],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们自己设计了两个函数，来生成元素节点或者文本节点。文本节点的<code>type</code>为”TEXT_ELEMENT“,且将children置为空数组。这样就可以区分不同的<code>child</code>了。</p>
<p>接下来就是<code>render</code>部分了：follow step by step.</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">element, container</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// TODO create dom nodes</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">element, container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dom = <span class="built_in">document</span>.createElement(element.type)</span><br><span class="line"></span><br><span class="line">  container.appendChild(dom)</span><br><span class="line">&#125;<span class="comment">// 将react元素转化为dom节点</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">element, container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dom = <span class="built_in">document</span>.createElement(element.type)</span><br><span class="line"></span><br><span class="line">  element.props.children.forEach(<span class="function"><span class="params">child</span> =&gt;</span></span><br><span class="line">    render(child, dom)</span><br><span class="line">  )<span class="comment">// 遍历children， 递归调用</span></span><br><span class="line"></span><br><span class="line">  container.appendChild(dom)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">element, container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dom =</span><br><span class="line">    element.type == <span class="string">"TEXT_ELEMENT"</span></span><br><span class="line">      ? <span class="built_in">document</span>.createTextNode(<span class="string">""</span>)</span><br><span class="line">      : <span class="built_in">document</span>.createElement(element.type)</span><br><span class="line">	<span class="comment">//dom可能为文本节点和元素节点两类</span></span><br><span class="line">  element.props.children.forEach(<span class="function"><span class="params">child</span> =&gt;</span></span><br><span class="line">    render(child, dom)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  container.appendChild(dom)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">element, container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> dom =</span><br><span class="line">    element.type == <span class="string">"TEXT_ELEMENT"</span></span><br><span class="line">      ? <span class="built_in">document</span>.createTextNode(<span class="string">""</span>)</span><br><span class="line">      : <span class="built_in">document</span>.createElement(element.type)</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">const</span> isProperty = <span class="function"><span class="params">key</span> =&gt;</span> key !== <span class="string">"children"</span> <span class="comment">//判断是不是children属性</span></span><br><span class="line">  <span class="built_in">Object</span>.keys(element.props)</span><br><span class="line">    .filter(isProperty)</span><br><span class="line">    .forEach(<span class="function"><span class="params">name</span> =&gt;</span> &#123;</span><br><span class="line">      dom[name] = element.props[name]</span><br><span class="line">    &#125;)<span class="comment">//将除了children属性的属性赋给节点</span></span><br><span class="line"></span><br><span class="line">  element.props.children.forEach(<span class="function"><span class="params">child</span> =&gt;</span></span><br><span class="line">    render(child, dom)</span><br><span class="line">  )</span><br><span class="line"></span><br><span class="line">  container.appendChild(dom)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在大概讲了render和元素的一些基本概念后（突然感觉跑偏了好多），react元素之间通过父子的关系形成了数的结构。</p>
<p>在某一时间节点调用 React 的 <code>render()</code> 方法，会创建一棵由 React 元素组成的树。在下一次 state 或 props 更新时，相同的 <code>render()</code> 方法会返回一棵不同的树。React 需要基于这两棵树之间的差别来判断如何高效的更新 UI，以保证当前 UI 与最新的树保持同步。</p>
<p>此算法有一些通用的解决方案，即生成将一棵树转换成另一棵树的最小操作次数。然而，即使使用<a href="http://grfia.dlsi.ua.es/ml/algorithms/references/editsurvey_bille.pdf" target="_blank" rel="noopener">最优的算法</a>，该算法的复杂程度仍为 O(n^3 )，其中 n 是树中元素的数量。</p>
<p>如果在 React 中使用该算法，那么展示 1000 个元素则需要 10 亿次的比较。这个开销实在是太过高昂。于是 React 在以下两个假设的基础之上提出了一套 O(n) 的启发式算法：</p>
<ol>
<li>两个不同类型的元素会产生出不同的树；</li>
<li>开发者可以通过设置 <code>key</code> 属性，来告知渲染哪些子元素在不同的渲染下可以保存不变；</li>
</ol>
<p>在实践中，我们发现以上假设在几乎所有实用的场景下都成立。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一次渲染</span></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;dialog&gt;</span><br><span class="line">    &lt;input /&gt;</span><br><span class="line">  &lt;<span class="regexp">/dialog&gt;,</span></span><br><span class="line"><span class="regexp">  domContainer</span></span><br><span class="line"><span class="regexp">);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 下一次渲染</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;dialog&gt;</span></span><br><span class="line"><span class="regexp">    &lt;p&gt;I was just added here!&lt;/</span>p&gt;    <span class="xml"><span class="tag">&lt;<span class="name">input</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">dialog</span>&gt;</span></span>,</span><br><span class="line">  domContainer</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>react会对比元素类型，dialog ==&gt; dialog不变，仅比对更新有改变的属性；input ==&gt; p 发生了改变。删掉原来的节点，新建新的节点。(nothing) ==&gt; input ：需要重新创建一个 <code>input</code> 宿主实例。</p>
<p>在现实写代码我们不会多次调用render，而是在p标签的位置做一些手脚。</p>
<p>而当遇到动态列表时，我们不能确定其中的顺序总是一成不变的。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShoppingList</span>(<span class="params">&#123; list &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &#123;list.map(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">        &lt;p&gt;</span><br><span class="line">          You bought &#123;item.name&#125;</span><br><span class="line">          &lt;br /&gt;</span><br><span class="line">          Enter how many <span class="keyword">do</span> you want: <span class="xml"><span class="tag">&lt;<span class="name">input</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>如果我们的商品列表被重新排序了，React 只会看到所有的 <code>p</code> 以及里面的 <code>input</code> 拥有相同的类型，并不知道该如何移动它们。（在 React 看来，虽然这些商品本身改变了，但是它们的顺序并没有改变。）</p>
<p>所以 React 会对这十个商品进行类似如下的重排序：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">let</span> pNode = formNode.childNodes[i];</span><br><span class="line">  <span class="keyword">let</span> textNode = pNode.firstChild;</span><br><span class="line">  textNode.textContent = <span class="string">'You bought '</span> + items[i].name;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>React 只会对其中的每个元素进行更新而不是将其重新排序。这样做会造成性能上的问题和潜在的 bug 。例如，当商品列表的顺序改变时，原本在第一个输入框的内容仍然会存在于现在的第一个输入框中 — 尽管事实上在商品列表里它应该代表着其他的商品！</p>
<p><strong>这就是为什么每次当输出中包含元素数组时，React 都会让你指定一个叫做 <code>key</code> 的属性：</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShoppingList</span>(<span class="params">&#123; list &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;form&gt;</span><br><span class="line">      &#123;list.map(<span class="function"><span class="params">item</span> =&gt;</span> (</span><br><span class="line">        &lt;p key=&#123;item.productId&#125;&gt;          You bought &#123;item.name&#125;</span><br><span class="line">          &lt;br /&gt;</span><br><span class="line">          Enter how many <span class="keyword">do</span> you want: <span class="xml"><span class="tag">&lt;<span class="name">input</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p><code>key</code> 给予 React 判断子元素是否真正相同的能力，即使在渲染前后它在父元素中的位置不是相同的。</p>
<p>当 React 在 <code>&lt;form&gt;</code> 中发现 <code>&lt;p key=&quot;42&quot;&gt;</code> ，它就会检查之前版本中的 <code>&lt;form&gt;</code> 是否同样含有 <code>&lt;p key=&quot;&quot;42&gt;</code> 。即使 <code>&lt;form&gt;</code> 中的子元素们改变位置后，这个方法同样有效。在渲染前后当 key 仍然相同时，React 会重用先前的宿主实例，然后重新排序其兄弟元素。</p>
<p>需要注意的是 <code>key</code> 只与特定的父亲 React 元素相关联，比如 <code>&lt;form&gt;</code> 。React 并不会去匹配父元素不同但 key 相同的子元素。（React 并没有惯用的支持对在不重新创建元素的情况下让宿主实例在不同的父元素之间移动。）</p>
<p>给 <code>key</code> 赋予什么值最好呢？最好的答案就是：<strong>什么时候你会说一个元素不会改变即使它在父元素中的顺序被改变？</strong> 例如，在我们的商品列表中，商品本身的 ID 是区别于其他商品的唯一标识，那么它就最适合作为 <code>key</code> 。</p>
<p>最后，你也可以使用元素在数组中的下标作为 key。这个策略在元素不进行重新排序时比较合适，如果有顺序修改，diff 就会变慢。</p>
<p>当基于下标的组件进行重新排序时，组件 state 可能会遇到一些问题。由于组件实例是基于它们的 key 来决定是否更新以及复用，如果 key 是一个下标，那么修改顺序时会修改当前的 key，导致非受控组件的 state（比如输入框）可能相互篡改，会出现无法预期的变动。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/React%20Redux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/React%20Redux/" class="post-title-link" itemprop="url">React Redux</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:58" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:58+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-10-31 14:21:22" itemprop="dateModified" datetime="2020-10-31T14:21:22+08:00">2020-10-31</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Connect"><a href="#Connect" class="headerlink" title="Connect()"></a><code>Connect()</code></h1><p><code>Connect()</code>是连接<code>React</code>和<code>Redux store</code>的函数。</p>
<p>它可以从<code>Store</code>当中拿出一些碎片的数据，传递给和它相连的组件。函数还可以发送一些<code>action</code>给<code>Store</code>。</p>
<p>它不会修改传递给它的组件类。而是返回一个新的，已连接的组件类，该类包含传入的组件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">connect</span>(<span class="params">mapStateToProps?, mapDispatchToProps?, mergeProps?, options?</span>)</span></span><br></pre></td></tr></table></figure>

<p><code>mapStateToProps</code>和<code>mapDispatchToProps</code>分别处理的是<code>Redux Store</code>的<code>state</code>数据和<code>dispatch</code>方法。</p>
<p>函数返回的<code>mapStateToProps</code>和<code>mapDispatchToProps</code>分别指向组件内部的<code>stateProps</code>和<code>dispatchProps</code>。</p>
<h2 id="connect-参数"><a href="#connect-参数" class="headerlink" title="connect() 参数"></a><code>connect()</code> 参数</h2><p><code>connect</code> 可以接受四个不同的参数, 全部都是可选的：</p>
<ol>
<li><code>mapStateToProps?: Function</code></li>
<li><code>mapDispatchToProps?: Function | Object</code></li>
<li><code>mergeProps?: Function</code></li>
<li><code>options?: Object</code></li>
</ol>
<h1 id="Connect-Extracting-Data-with-mapStateToProps"><a href="#Connect-Extracting-Data-with-mapStateToProps" class="headerlink" title="Connect: Extracting Data with mapStateToProps"></a>Connect: Extracting Data with <code>mapStateToProps</code></h1><p>作为第一个传入<code>connect</code>的参数，<code>mapStateToProps</code>从<code>Store</code>选择一部分数据，传给需要的组件。</p>
<ul>
<li>当<code>store</code>的<code>state</code>数据变化的时候会调用改函数。</li>
<li>它接受一整个<code>store state</code>，返回一个对象包含组件需要的数据。</li>
</ul>
<h2 id="定义-mapStateToProps"><a href="#定义-mapStateToProps" class="headerlink" title="定义 mapStateToProps"></a>定义 <code>mapStateToProps</code></h2><p><code>mapStateToProps</code>应该被定义为一个函数：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state, ownProps?</span>)</span></span><br></pre></td></tr></table></figure>

<p>它应该接受一个名为<code>state</code>的第一个参数，可以选择一个称为<code>ownProps</code>的第二个参数，并返回一个包含连接组件所需数据的普通对象。</p>
<p>此函数应作为<code>connect</code>的第一个参数传递，并将在每次<code>Redux</code>存储状态更改时调用。如果您不想订阅存储，请传递<code>null</code>或undefined来代替<code>mapStateToProps</code>进行连接。</p>
<p>不管<code>mapstatetops</code>函数是使用<code>function</code>关键字<code>（function mapState（state）{}）</code>还是作为箭头函数<code>（constmapstate=（state）=&gt;{}</code>编写的，它的工作方式都是一样的。</p>
<h3 id="Arguments"><a href="#Arguments" class="headerlink" title="Arguments"></a>Arguments</h3><ol>
<li><strong><code>state</code></strong></li>
<li><strong><code>ownProps</code> (可选的)</strong></li>
</ol>
<h4 id="state"><a href="#state" class="headerlink" title="state"></a><code>state</code></h4><p><code>mapStateToProps</code>函数的第一个参数是整个<code>Redux</code>存储状态（调用存储.<code>getState()</code>). 因此，第一个论点传统上被称为<code>state</code>。（虽然您可以给参数指定任何名称，但将其称为store是不正确的-它是“state value”，而不是“store instance”。）</p>
<p>至少state作为参数是应该被传入到mapStateToProps函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; todos &#125; = state</span><br><span class="line">  <span class="keyword">return</span> &#123; <span class="attr">todoList</span>: todos.allIds &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(TodoList)</span><br></pre></td></tr></table></figure>

<h4 id="ownProps-optional"><a href="#ownProps-optional" class="headerlink" title="ownProps (optional)"></a><code>ownProps</code> (optional)</h4><p>如果组件需要从自己的属性中获取数据来从存储中检索数据，则可以使用第二个参数ownProps定义函数。此参数将包含给connect生成的包装器组件的所有属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state, ownProps</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; visibilityFilter &#125; = state</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = ownProps</span><br><span class="line">  <span class="keyword">const</span> todo = getTodoById(state, id)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// component receives additionally:</span></span><br><span class="line">  <span class="keyword">return</span> &#123; todo, visibilityFilter &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Later, in your application, a parent component renders:</span></span><br><span class="line">;<span class="xml"><span class="tag">&lt;<span class="name">ConnectedTodo</span> <span class="attr">id</span>=<span class="string">&#123;123&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="xml">// and your component receives props.id, props.todo, and props.visibilityFilter</span></span><br></pre></td></tr></table></figure>

<h3 id="Return"><a href="#Return" class="headerlink" title="Return"></a>Return</h3><p>mapToProps函数应返回一个包含组件所需数据的纯对象：</p>
<ul>
<li>Each field in the object will become a prop for your actual component</li>
<li>The values in the fields will be used to determine if your component needs to re-render</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapStateToProps</span>(<span class="params">state</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    a: <span class="number">42</span>,</span><br><span class="line">    todos: state.todos,</span><br><span class="line">    filter: state.visibilityFilter</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// component will receive: props.a, props.todos, and props.filter</span></span><br></pre></td></tr></table></figure>

<h2 id="Usage-Guidelines"><a href="#Usage-Guidelines" class="headerlink" title="Usage Guidelines"></a>Usage Guidelines</h2><ol>
<li><h3 id="Let-mapStateToProps-Reshape-the-Data-from-the-Store"><a href="#Let-mapStateToProps-Reshape-the-Data-from-the-Store" class="headerlink" title="Let mapStateToProps Reshape the Data from the Store"></a>Let <code>mapStateToProps</code> Reshape the Data from the Store</h3></li>
<li><h3 id="Use-Selector-Functions-to-Extract-and-Transform-Data"><a href="#Use-Selector-Functions-to-Extract-and-Transform-Data" class="headerlink" title="Use Selector Functions to Extract and Transform Data"></a>Use Selector Functions to Extract and Transform Data</h3></li>
<li><h3 id="mapStateToProps-Functions-Should-Be-Fast"><a href="#mapStateToProps-Functions-Should-Be-Fast" class="headerlink" title="mapStateToProps Functions Should Be Fast"></a><code>mapStateToProps</code> Functions Should Be Fast</h3></li>
<li><h3 id="mapStateToProps-Functions-Should-Be-Pure-and-Synchronous"><a href="#mapStateToProps-Functions-Should-Be-Pure-and-Synchronous" class="headerlink" title="mapStateToProps Functions Should Be Pure and Synchronous"></a><code>mapStateToProps</code> Functions Should Be Pure and Synchronous</h3></li>
</ol>
<h1 id="Connect-Dispatching-Actions-with-mapDispatchToProps"><a href="#Connect-Dispatching-Actions-with-mapDispatchToProps" class="headerlink" title="Connect: Dispatching Actions with mapDispatchToProps"></a>Connect: Dispatching Actions with <code>mapDispatchToProps</code></h1><p>作为传递给connect的第二个参数，mapDispatchToProps用于将操作分派到存储区。</p>
<p><code>dispatch</code>是Redux Store之中唯一的函数。我们只有调用<code>store.dispatch</code>去发送一个<code>action</code>。</p>
<p>使用React Redux，您的组件永远不会直接访问存储区—connect会为您执行此操作。React Redux为您提供了两种让组件分派操作的方法：</p>
<ul>
<li>By default, a connected component receives <code>props.dispatch</code> and can dispatch actions itself.</li>
<li><code>connect</code> can accept an argument called <code>mapDispatchToProps</code>, which lets you create functions that dispatch when called, and pass those functions as props to your component.</li>
</ul>
<h2 id="Approaches-for-Dispatching"><a href="#Approaches-for-Dispatching" class="headerlink" title="Approaches for Dispatching"></a>Approaches for Dispatching</h2><h3 id="Default-dispatch-as-a-Prop"><a href="#Default-dispatch-as-a-Prop" class="headerlink" title="Default: dispatch as a Prop"></a>Default: <code>dispatch</code> as a Prop</h3><p>如果不指定connect（）的第二个参数，则默认情况下，组件将接收dispatch。例如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">connect()(MyComponent)</span><br><span class="line"><span class="comment">// which is equivalent with</span></span><br><span class="line">connect(</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  <span class="literal">null</span></span><br><span class="line">)(MyComponent)</span><br><span class="line"></span><br><span class="line"><span class="comment">// or</span></span><br><span class="line">connect(mapStateToProps <span class="comment">/** no second argument */</span>)(MyComponent)</span><br></pre></td></tr></table></figure>

<p>以这种方式连接组件后，组件将接收道具调度. 您可以使用它将操作分派到存储。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123; count, dispatch &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; <span class="attr">type</span>: <span class="string">'DECREMENT'</span> &#125;)&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">      &lt;span&gt;&#123;count&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; type: 'INCREMENT' &#125;)&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; dispatch(&#123; <span class="attr">type</span>: <span class="string">'RESET'</span> &#125;)&#125;&gt;reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Providing-A-mapDispatchToProps-Parameter"><a href="#Providing-A-mapDispatchToProps-Parameter" class="headerlink" title="Providing A mapDispatchToProps Parameter"></a>Providing A <code>mapDispatchToProps</code> Parameter</h3><p>提供mapDispatchToProps允许您指定哪一种的<code>action</code>需要被分派。它允许您提供<code>action dispatch</code>作为传参。因此，与其调用函数<code>props.dispatch(()=&gt;increment())</code>，可以调用直接调用<code>prop.increment()</code>。你可能想这么做有几个原因。</p>
<h4 id="More-Declarative"><a href="#More-Declarative" class="headerlink" title="More Declarative"></a>More Declarative</h4><p>首先，将<code>dispatch</code>逻辑封装到函数中使实现更具声明性。<code>dispatch</code>一个动作并让Redux存储处理数据流是如何实现行为的，而不是它做什么。</p>
<p>一个很好的例子是在单击按钮时<code>dispatch</code>操作。直接连接按钮在概念上可能没有意义，按钮引用<code>dispatch</code>也没有意义。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// button needs to be aware of "dispatch"</span></span><br><span class="line">&lt;button onClick=&#123;() =&gt; dispatch(&#123; <span class="attr">type</span>: <span class="string">"SOMETHING"</span> &#125;)&#125; /&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// button unaware of "dispatch",</span></span><br><span class="line">&lt;button onClick=&#123;doSomething&#125; /&gt;</span><br></pre></td></tr></table></figure>

<p>一旦您用<code>dispatch</code>动作的函数包装了所有<code>action</code>创建者，组件就不需要分派了。因此，如果您定义自己的<code>mapDispatchToProps</code>，则连接的组件将不再接收<code>dispatch</code>。</p>
<h4 id="Pass-Down-Action-Dispatching-Logic-to-Unconnected-Child-Components"><a href="#Pass-Down-Action-Dispatching-Logic-to-Unconnected-Child-Components" class="headerlink" title="Pass Down Action Dispatching Logic to ( Unconnected ) Child Components"></a>Pass Down Action Dispatching Logic to ( Unconnected ) Child Components</h4><p>此外，您还可以将操作分派函数传递给子（可能是未连接的）组件。这允许更多的组件分派动作，同时让它们“不知道”Redux。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// pass down toggleTodo to child component</span></span><br><span class="line"><span class="comment">// making Todo able to dispatch the toggleTodo action</span></span><br><span class="line"><span class="keyword">const</span> TodoList = <span class="function">(<span class="params">&#123; todos, toggleTodo &#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;todos.map(<span class="function"><span class="params">todo</span> =&gt;</span> (</span><br><span class="line">      &lt;Todo todo=&#123;todo&#125; onClick=&#123;toggleTodo&#125; /&gt;</span><br><span class="line">    ))&#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure>

<p>这就是<code>React Redux</code>的<code>connect</code>所做的——它封装了与<code>Redux store</code>对话的逻辑，让您不用担心它。这是你应该在你的实现中充分利用的。</p>
<h2 id="Two-Forms-of-mapDispatchToProps"><a href="#Two-Forms-of-mapDispatchToProps" class="headerlink" title="Two Forms of mapDispatchToProps"></a>Two Forms of <code>mapDispatchToProps</code></h2><p>mapDispatchToProps参数可以有两种形式。虽然函数形式允许更多的定制，但对象形式易于使用。</p>
<ul>
<li><strong>Function form</strong>: Allows more customization, gains access to <code>dispatch</code> and optionally <code>ownProps</code></li>
<li><strong>Object shorthand form</strong>: More declarative and easier to use</li>
</ul>
<h2 id="Defining-mapDispatchToProps-As-A-Function"><a href="#Defining-mapDispatchToProps-As-A-Function" class="headerlink" title="Defining mapDispatchToProps As A Function"></a>Defining <code>mapDispatchToProps</code> As A Function</h2><p>将<code>mapDispatchToProps</code>定义为一个函数，可以在自定义组件接收的函数以及它们如何分派操作方面提供最大的灵活性。你可以获得调度和拥有权。您可以利用这个机会编写自定义函数，以供连接的组件调用。</p>
<h3 id="Arguments-1"><a href="#Arguments-1" class="headerlink" title="Arguments"></a>Arguments</h3><ol>
<li><strong><code>dispatch</code></strong></li>
<li><strong><code>ownProps</code> (optional)</strong></li>
</ol>
<p><strong><code>dispatch</code></strong></p>
<p>将调用<code>mapDispatchToProps</code>函数，并将<code>dispatch</code>作为第一个参数。通常，通过返回在其内部调用<code>dispatch()</code>的新函数，并直接传入纯操作对象或传入操作创建者的结果来使用此方法。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// dispatching plain actions</span></span><br><span class="line">    increment: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(&#123; <span class="attr">type</span>: <span class="string">'INCREMENT'</span> &#125;),</span><br><span class="line">    decrement: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(&#123; <span class="attr">type</span>: <span class="string">'DECREMENT'</span> &#125;),</span><br><span class="line">    reset: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(&#123; <span class="attr">type</span>: <span class="string">'RESET'</span> &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您还可能希望将参数转发给<code>action creator</code>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// explicitly forwarding arguments</span></span><br><span class="line">    onClick: <span class="function"><span class="params">event</span> =&gt;</span> dispatch(trackClick(event)), <span class="comment">//trackClick() is an anction creator</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// implicitly forwarding arguments</span></span><br><span class="line">    onReceiveImpressions: <span class="function">(<span class="params">...impressions</span>) =&gt;</span></span><br><span class="line">      dispatch(trackImpressions(impressions)) <span class="comment">//trackImpressions() is also an anction creator</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>ownProps</code> ( optional )</strong></p>
<p>如果您的<code>mapDispatchToProps</code>函数被声明为接受两个参数，那么它将被调用，第一个参数是dispatch，传递给连接组件的属性作为第二个参数，并且在连接的组件接收到新的属性时将重新调用它。</p>
<p>这意味着，在组件重新呈现时，您可以在组件的属性发生更改时进行重新绑定，而不是在组件重新呈现时将新的属性重新绑定到<code>action dispatchers</code>。</p>
<p><strong>Binds on component mount</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.props.toggleTodo(this.props.todoId)&#125; /&gt;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">const mapDispatchToProps = dispatch =&gt; &#123;</span></span><br><span class="line"><span class="xml">  return &#123;</span></span><br><span class="line"><span class="xml">    toggleTodo: todoId =&gt; dispatch(toggleTodo(todoId))</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>Binds on <code>props</code> change</strong></p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.props.toggleTodo()&#125; /&gt;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">const mapDispatchToProps = (dispatch, ownProps) =&gt; &#123;</span></span><br><span class="line"><span class="xml">  return &#123;</span></span><br><span class="line"><span class="xml">    toggleTodo: () =&gt; dispatch(toggleTodo(ownProps.todoId))</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="Return-1"><a href="#Return-1" class="headerlink" title="Return"></a>Return</h3><p><code>mapDispatchToProps</code>函数应返回一个纯对象：</p>
<ul>
<li>Each field in the object will become a separate prop for your own component, and the value should normally be a function that dispatches an action when called.</li>
<li>If you use action creators ( as oppose to plain object actions ) inside <code>dispatch</code>, it is a convention to simply name the field key the same name as the action creator:</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> increment = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'INCREMENT'</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> decrement = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'DECREMENT'</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> reset = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'RESET'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mapDispatchToProps = <span class="function"><span class="params">dispatch</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="comment">// dispatching actions returned by action creators</span></span><br><span class="line">    increment: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(increment()),</span><br><span class="line">    decrement: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(decrement()),</span><br><span class="line">    reset: <span class="function"><span class="params">()</span> =&gt;</span> dispatch(reset())</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>mapDispatchToProps</code>函数的返回将作为道具合并到连接的组件中。你可以直接调用他们，让他们<code>dispatch action</code>。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Counter</span>(<span class="params">&#123; count, increment, decrement, reset &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;button onClick=&#123;decrement&#125;&gt;-<span class="xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">      &lt;span&gt;&#123;count&#125;&lt;<span class="regexp">/span&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;increment&#125;&gt;+&lt;/</span>button&gt;</span><br><span class="line">      &lt;button onClick=&#123;reset&#125;&gt;reset&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Defining-the-mapDispatchToProps-Function-with-bindActionCreators"><a href="#Defining-the-mapDispatchToProps-Function-with-bindActionCreators" class="headerlink" title="Defining the mapDispatchToProps Function with bindActionCreators"></a>Defining the <code>mapDispatchToProps</code> Function with <code>bindActionCreators</code></h3><p>手动的将这些函数包装起来是可笑的，所以Redux提供了一个函数去简化。</p>
<p><code>bindActionCreators</code> accepts two parameters:</p>
<ol>
<li>A <strong><code>function</code></strong> (an action creator) or an <strong><code>object</code></strong> (each field an action creator)</li>
<li><code>dispatch</code></li>
</ol>
<p><code>bindActionCreators</code>生成的包装器函数将自动转发它们的所有参数，因此您不需要手动执行此操作。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> increment = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'INCREMENT'</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> decrement = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'DECREMENT'</span> &#125;)</span><br><span class="line"><span class="keyword">const</span> reset = <span class="function"><span class="params">()</span> =&gt;</span> (&#123; <span class="attr">type</span>: <span class="string">'RESET'</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// binding an action creator</span></span><br><span class="line"><span class="comment">// returns (...args) =&gt; dispatch(increment(...args))</span></span><br><span class="line"><span class="keyword">const</span> boundIncrement = bindActionCreators(increment, dispatch)</span><br><span class="line"></span><br><span class="line"><span class="comment">// binding an object full of action creators</span></span><br><span class="line"><span class="keyword">const</span> boundActionCreators = bindActionCreators(</span><br><span class="line">  &#123; increment, decrement, reset &#125;,</span><br><span class="line">  dispatch</span><br><span class="line">)</span><br><span class="line"><span class="comment">// returns</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//   increment: (...args) =&gt; dispatch(increment(...args)),</span></span><br><span class="line"><span class="comment">//   decrement: (...args) =&gt; dispatch(decrement(...args)),</span></span><br><span class="line"><span class="comment">//   reset: (...args) =&gt; dispatch(reset(...args)),</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<p>To use <code>bindActionCreators</code> in our <code>mapDispatchToProps</code> function:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> bindActionCreators(&#123; increment, decrement, reset &#125;, dispatch)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// component receives props.increment, props.decrement, props.reset</span></span><br><span class="line">connect(</span><br><span class="line">  <span class="literal">null</span>,</span><br><span class="line">  mapDispatchToProps</span><br><span class="line">)(Counter)</span><br></pre></td></tr></table></figure>

<h3 id="Manually-Injecting-dispatch"><a href="#Manually-Injecting-dispatch" class="headerlink" title="Manually Injecting dispatch"></a>Manually Injecting <code>dispatch</code></h3><p>如果提供了<code>mapDispatchToProps</code>参数，组件将不再接收默认分派。您可以通过手动将其添加到<code>mapDispatchToProps</code>的返回中来恢复它，尽管大多数情况下您不需要这样做：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mapDispatchToProps</span>(<span class="params">dispatch</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    dispatch,</span><br><span class="line">    ...bindActionCreators(&#123; increment, decrement, reset &#125;, dispatch)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Defining-mapDispatchToProps-As-An-Object"><a href="#Defining-mapDispatchToProps-As-An-Object" class="headerlink" title="Defining mapDispatchToProps As An Object"></a>Defining <code>mapDispatchToProps</code> As An Object</h2><p>您已经看到，在React组件中调度Redux动作的设置过程非常相似：定义一个动作创建者，将其包装在另一个类似于的函数中<code>(…args) =&gt; dispatch(actionCreator(…args))</code>，并将该包装函数作为prop传递给您的组件。</p>
<p>因为这很普遍，所以<code>connect</code>支持参数的“对象简写”形式<code>mapDispatchToProps</code>：如果传递的对象中包含操作创建者而不是函数，<code>connect</code>则将<code>bindActionCreators</code>在内部自动调用您。</p>
<p><strong>我们建议始终使用的“对象简写”形式<code>mapDispatchToProps</code>，除非您有特定的原因自定义调度行为。</strong></p>
<p>注意：</p>
<ul>
<li><code>mapDispatchToProps</code>假定对象的每个字段都是动作创建者</li>
<li>您的组件将不再<code>dispatch</code>作为道具接收</li>
</ul>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// React Redux does this for you automatically:</span></span><br><span class="line">dispatch =&gt; bindActionCreators(mapDispatchToProps, dispatch)</span><br></pre></td></tr></table></figure>

<p>Therefore, our <code>mapDispatchToProps</code> can simply be:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> mapDispatchToProps = &#123;</span><br><span class="line">  increment,</span><br><span class="line">  decrement,</span><br><span class="line">  reset</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Since the actual name of the variable is up to you, you might want to give it a name like <code>actionCreators</code>, or even define the object inline in the call to <code>connect</code>:</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;increment, decrement, reset&#125; <span class="keyword">from</span> <span class="string">"./counterActions"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> actionCreators = &#123;</span><br><span class="line">  increment,</span><br><span class="line">  decrement,</span><br><span class="line">  reset</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapState, actionCreators)(Counter);</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(</span><br><span class="line">  mapState,</span><br><span class="line">  &#123; increment, decrement, reset &#125;</span><br><span class="line">)(Counter);</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/%E9%8D%93%E5%B6%87%EE%81%AC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/%E9%8D%93%E5%B6%87%EE%81%AC/" class="post-title-link" itemprop="url">鍓嶇</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:56" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:56+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-21 13:04:16" itemprop="dateModified" datetime="2021-05-21T13:04:16+08:00">2021-05-21</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这篇文章主要是来分享一下我这一年多时间以来在前端方面学习的方法和路径。</p>
<h2 id="什么是前端？"><a href="#什么是前端？" class="headerlink" title="什么是前端？"></a>什么是前端？</h2><p>为用户提供可交互的可视化界面。在传统的MVC式的开发当中，M为Model模型，V为View视图，C为Controller控制器。而前后端分离之后，前端主要负责的是V视图的部分。而如今前端早已不再是只能开发web方向了，如今它也具有数据可视化，垮端技术，中后台技术等方向。</p>
<h2 id="如何学习前端？"><a href="#如何学习前端？" class="headerlink" title="如何学习前端？"></a>如何学习前端？</h2><p>其实如何前端这个话题和如何学习是一个道理，我们其实只要掌握了学习的方法，用来学习什么都。</p>
<ol>
<li>独立解决问题的能力。</li>
<li>独立思考能力。</li>
<li>英语阅读能力。</li>
</ol>
<p>独立解决问题主要在于怎么提高自己的搜商。在如今互联网发达的时代，很多东西都是可以自己找到问题的答案的。那么难点就在于如何抽象出来问题，和提炼搜索内容。同样的问题可能有不同的关键字那么出来的结果就可能不一样。</p>
<p>独立思考能力，这一点也不用多说，凡事只有自己多思考过了才能成为自己的东西。我们在除了光去查去看了之后也要多实践。有时候看了也只是看了，多动手去写写代码。</p>
<p>而英语阅读能力也很重要在于英文文献的阅读，有很多时候我们中文的搜索解决不了我们的问题，这个时候我们就可以用英文去搜索并且阅读英文的文献。再者国外很多技术都比国内发展更好一些，所以要了解比较新的技术也需要去阅读英文。</p>
<p>其实以上说的这些点也不局限于前端的学习，而更多是通用的现代学习方法。</p>
<h2 id="前端三大基石"><a href="#前端三大基石" class="headerlink" title="前端三大基石"></a>前端三大基石</h2><p>HTML</p>
<p>HTML的全称为超文本标记语言，是一种标记语言。它包括一系列标签．通过这些标签可以将网络上的文档格式统一，使分散的Internet资源连接为一个逻辑整体。HTML文本是由HTML命令组成的描述性文本，HTML命令可以说明文字，图形、动画、声音、表格、链接。</p>
<p>CSS</p>
<p>层叠样式表(英文全称：Cascading Style Sheets)是一种用来表现HTML（标准通用标记语言的一个应用）或XML（标准通用标记语言的一个子集）等文件样式的计算机语言。CSS不仅可以静态地修饰网页，还可以配合各种脚本语言动态地对网页各元素进行格式化。</p>
<p>Javascript</p>
<p>JavaScript（简称“JS”） 是一种具有函数优先的轻量级，解释型或即时编译型的编程语言。虽然它是作为开发Web页面的脚本语言而出名，但是它也被用到了很多非浏览器环境中，JavaScript 基于原型编程、多范式的动态脚本语言，并且支持面向对象、命令式和声明式（如函数式编程）风格。</p>
<p>Javascript衍生的学习内容就十分的多，介于JavaScript的弱类型的语言，微软推出了对应的强类型语言TypeScript。</p>
<p>CSS的预处理的编译也有许多Less和SCSS都是可以去学一学，在开发更大型的项目的时候使用更好。</p>
<p>关于前端的框架来说，三大热门的框架React、Vue和Angular。这三个框架是基于Javascript的Web开发框架。了解这些内容之前我们应该要学习DOM和CSSOM等内容，Javascript是如何操控DOM元素的。</p>
<p>这里就又要问一个问题了，你们为什么学习前端？就业？写项目？感兴趣？</p>
<p>为什么要问这个问题呢？其实就是一个时间成本的问题。其实大家在学了HTML之后，学习Vue要更容易上手，因为它的视图和模块区分的更明显，还有就是是它的开发团队当中有许多的中国人，中文文档阅读起来也是十分方便且中文文档的质量也十分的高。十分推荐只是用来写项目的同学去学习，相比于React框架来说时间成本要低很多。</p>
<p>那么更想以前端就业的同学来说学习React和Vue 也是都要去学习和了解的框架。React相对于Vue来说需要了解class组件和它对应的声明周期。当然在16年后？他们也推出了React Hooks。从class组件变成了函数组件。用函数的思想去写组件可以使更多的组件抽取更加容易。</p>
<p>除了基本的React和Vue框架，也有对应的包去学习。Router实现路由跳转，Redux实现状态的管理。在比较简单的项目当中，不推荐使用Redux。刚刚开始学习写项目时候，我不建议去使用别人写好的组件。例如Antd这个比较知名的阿里前端开发的开源组件库。</p>
<p>当我们需要开发小程序的时候推荐一些框架。Taro框架是现在可以支持React和Vue的开发一个比较丰富的框架。但是现在Taro框架还是不太稳定，bug还挺多的。</p>
<p>当然这里说的都是一些关于前端web开发的部分，在实现可视化和中后台的方面还没有特别深入了解，也就不好多说什么了。我也最近才刚刚开始学习nodejs一些简单的服务搭建的。</p>
<h2 id="计算机基础"><a href="#计算机基础" class="headerlink" title="计算机基础"></a>计算机基础</h2><p>计算机基础是一个要成为专业的程序猿必备的技能了，也不管你在哪个领域里面所需要知道和了解的。</p>
<p>第一个就是C语言的学习，了解到其实我们院20级的管工的同学并没有C语言这门课，还是推荐大家在学习数据结构的时候把C语言的结构体，指针等概念了解清楚。</p>
<p>数据结构和算法</p>
<p>数据结构也是比较基础的一门课，链表，队列，堆栈，数组，串，二叉树等概念是我们专业所学习的，但是还有像图等我们专业都不会讲解，可以看看熊回香老师的那本书，也是写的很好的。在加上算法，书里面讲到的比较基础的算法有查找和排序，查找有二分法，二叉排序树，嘻哈表。排序有直接插入，选择排序，推排序，冒泡排序，快速排序，归并排序，桶排序等。这些排序和查找最后考试也是都会考的。</p>
<p>我们专业在数据结构这方面出的代码设计题会比较简单，导致你不需要动手去实践已知的一些算法，可能只需要逻辑上理解就够了，而我们要知道逻辑上面的理解和能真正把代码写出来是两回事。我自己也是吃了这方面的亏，自己刷题的时候也是知道怎么去完成，但是代码多多少少都会出现一点bug。</p>
<p>虽然前端对算法的要求部不是特别高，但是也不是没有要求的，所以多刷题多总结就没什么错了。</p>
<p>计算机网络</p>
<p>计算机网络我们学院开设的课程主要集中于在应用层之下了，而我们实际的网络开发，更多的需要的知识是应用层的，http协议就是应用层的主要协议。这个大家可以看老师推荐的教材或者《图解HTTP》这本书。</p>
<p>剩余的操作系统和计算机组成原理里面，还是推荐大家可以多多学习操作系统，机组的话可能更多的偏向硬件一些，学起来可能回比较枯燥乏味。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/%E9%91%B7%EE%81%88%E2%82%AC%E5%82%9A%E7%B0%B2%E7%81%9E%E5%91%AC%E8%85%91/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/%E9%91%B7%EE%81%88%E2%82%AC%E5%82%9A%E7%B0%B2%E7%81%9E%E5%91%AC%E8%85%91/" class="post-title-link" itemprop="url">鑷€傚簲灞呬腑</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:55" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:55+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-08 15:51:08" itemprop="dateModified" datetime="2019-11-08T15:51:08+08:00">2019-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="关于网页布局中的水平垂直居中"><a href="#关于网页布局中的水平垂直居中" class="headerlink" title="关于网页布局中的水平垂直居中"></a>关于网页布局中的水平垂直居中</h1><h3 id="一、首先来分享最简单的flex布局中如何居中"><a href="#一、首先来分享最简单的flex布局中如何居中" class="headerlink" title="一、首先来分享最简单的flex布局中如何居中"></a>一、首先来分享最简单的flex布局中如何居中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;<span class="comment">/*水平居中*/</span></span><br><span class="line">    <span class="attribute">align-items</span>: center;<span class="comment">/*垂直居中*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        这里father指的是夫元素的盒子，对父元素进行设置<code>display: flex;</code>其中的子元素就会变成项目，父元素本身就成为了flex容器。利用flex的一些特性就可以进行居中的布局。</p>
<p>​        关于更详细的flex布局，这里有一个链接：<a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool" target="_blank" rel="noopener">http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html?utm_source=tuicool</a></p>
<h3 id="二、”display-inline-block”中如何实现居中"><a href="#二、”display-inline-block”中如何实现居中" class="headerlink" title="二、”display:inline-block”中如何实现居中"></a>二、”display:inline-block”中如何实现居中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">text-align</span>: center;<span class="comment">/*水平居中*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:inline-block;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        当block变成inline-block时，多个div在一个父元素的容器中，<code>margin: 0 auto；</code>就不再有作用。目前我找到的方法只有在父元素中设置<code>text-align: center;</code>使这些div居中。百度中这么解释到，“我们的行内元素就相当于一行之内的文字了”，我也只能这么理解了。对于div中的文字，我们只能再使用<code>text-align: start；</code>之类的属性来使文字排版更理想化。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>:auto;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">200px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.father</span><span class="selector-pseudo">:after</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:inline-block;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">font-size</span>:<span class="number">0</span>;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:inline-block;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;<span class="comment">/*垂直居中*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        这一串css代码是用来inline-block当中的垂直居中问题，可以用于head当中，因为大多时候head定宽，用一个伪元素设置其高度为100%时，将父元素撑开，子元素就垂直居中啦！也适用于多行文字！</p>
<h6 id="当然如果head之中只有一行文字，在父元素中设置height与line-height相等时，也可以垂直居中，只是会出现一些小问题。比如只是文字居中而div没有居中。（如果div高和head高不相等）"><a href="#当然如果head之中只有一行文字，在父元素中设置height与line-height相等时，也可以垂直居中，只是会出现一些小问题。比如只是文字居中而div没有居中。（如果div高和head高不相等）" class="headerlink" title="当然如果head之中只有一行文字，在父元素中设置height与line-height相等时，也可以垂直居中，只是会出现一些小问题。比如只是文字居中而div没有居中。（如果div高和head高不相等）"></a>当然如果head之中只有一行文字，在父元素中设置height与line-height相等时，也可以垂直居中，只是会出现一些小问题。比如只是文字居中而div没有居中。（如果div高和head高不相等）</h6><h3 id="三、“display：block”一个block的居中"><a href="#三、“display：block”一个block的居中" class="headerlink" title="三、“display：block”一个block的居中"></a>三、“display：block”一个block的居中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        这一串代码十分简洁，十分容易记住，但是一定要找到使用场合。在一个父元素只有一个子元素时，此代码可以时该元素自适应的居中，比较常用于head套用，page整体布局中。</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">height</span>:<span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>:<span class="number">100px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        不多说了，注意只能用于单行文字。会使子元素高度变大。</p>
<h3 id="四、“display-table”的居中"><a href="#四、“display-table”的居中" class="headerlink" title="四、“display: table”的居中"></a>四、“display: table”的居中</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:table;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">display</span>:table-cell;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        这种方法适用性不强，因为大多数display属性为block,inlin-block或者flex。再次使用display时可能会改变一些属性。</p>
<h3 id="五、定位"><a href="#五、定位" class="headerlink" title="五、定位"></a>五、定位</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        该方法用于son宽高已知！</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">500px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">300px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-50%) <span class="built_in">translateY</span>(-50%);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        该方法用于son宽高未知！</p>
<h6 id="总的来说自适应居中的方法就这些了，如果想看到更多的居中方式可以点击这里访问李雪莲学姐做的总结！！"><a href="#总的来说自适应居中的方法就这些了，如果想看到更多的居中方式可以点击这里访问李雪莲学姐做的总结！！" class="headerlink" title="总的来说自适应居中的方法就这些了，如果想看到更多的居中方式可以点击这里访问李雪莲学姐做的总结！！"></a>总的来说自适应居中的方法就这些了，如果想看到更多的居中方式可以点击这里访问李雪莲学姐做的总结！！</h6><p> <a href="https://lilixuelian.github.io/2019/05/22/center/" target="_blank" rel="noopener">https://lilixuelian.github.io/2019/05/22/center/</a> </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/%E9%97%83%E5%8F%89%E5%A7%88%E9%91%BA%E5%82%9B%E7%A5%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/%E9%97%83%E5%8F%89%E5%A7%88%E9%91%BA%E5%82%9B%E7%A5%A6/" class="post-title-link" itemprop="url">闃叉姈鑺傛祦</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:54" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:54+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-05-27 22:53:50" itemprop="dateModified" datetime="2021-05-27T22:53:50+08:00">2021-05-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>​    其实在了解防抖和节流的作用是什么了之后就实现起来会比较容易</p>
<h2 id="防抖"><a href="#防抖" class="headerlink" title="防抖"></a>防抖</h2><p>防抖是防止短时间内一直调用一个函数，在n秒后执行函数，在n秒内多次触发事件，则重新开始计时。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> request = <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"request: "</span> + val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">debounce</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timeout;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        clearTimeout(timeout);</span><br><span class="line">        timeout = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>);</span><br><span class="line">        &#125;, delay);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> inputEle = <span class="built_in">document</span>.getElementById(<span class="string">"input"</span>);</span><br><span class="line"><span class="keyword">let</span> debounceInput = debounce(request, <span class="number">500</span>);</span><br><span class="line"></span><br><span class="line">inputEle.addEventListener(<span class="string">"keyup"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">    debounceInput(e.target.value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="节流"><a href="#节流" class="headerlink" title="节流"></a>节流</h2><p>在规定时间内，函数只执行一次，在单位时间内触发多次也执行一次。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> request = <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"request: "</span> + val);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">throttle</span>(<span class="params">fn, delay</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!timer) &#123;</span><br><span class="line">            fn.apply(<span class="keyword">this</span>,<span class="built_in">arguments</span>);</span><br><span class="line">            timer = setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">                clearTimeout(timer);</span><br><span class="line">                time = <span class="literal">null</span>;</span><br><span class="line">            &#125;,delay)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然而让我考虑了好久这里为什么要使用apply方法去执行。我查到的原因就是因为request函数的参数个数未知性，应该直接传入arguments的参数对象。还可以改成fn(…arguments)。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/%E7%80%9B%E3%82%87%E5%AB%AD%E9%8F%84%E7%86%BA%E6%82%86--Taro%E5%A6%97%E5%97%98%E7%81%A6%E9%8E%AC%E8%8D%A4%E7%B2%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/%E7%80%9B%E3%82%87%E5%AB%AD%E9%8F%84%E7%86%BA%E6%82%86--Taro%E5%A6%97%E5%97%98%E7%81%A6%E9%8E%AC%E8%8D%A4%E7%B2%A8/" class="post-title-link" itemprop="url">瀛ょ嫭鏄熺悆--Taro妗嗘灦鎬荤粨</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:51" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:51+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-02 01:02:38" itemprop="dateModified" datetime="2020-04-02T01:02:38+08:00">2020-04-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="孤独星球–Taro框架总结"><a href="#孤独星球–Taro框架总结" class="headerlink" title="孤独星球–Taro框架总结"></a>孤独星球–Taro框架总结</h1><p>​        大一下学期用Taro框架写了QQ的小程序–孤独星球，项目链接在这里。<a href="https://github.com/The-Planet-of-Loneline/project" target="_blank" rel="noopener">https://github.com/The-Planet-of-Loneline/project</a></p>
<p>​        项目分为白天和黑夜两个部分，白天是同组的刘安完成的，技术含量也比较高；黑夜和登录部分就是由我完成的。接下来就说一下Taro里面的一些细节。</p>
<h3 id="一、项目结构"><a href="#一、项目结构" class="headerlink" title="一、项目结构"></a>一、项目结构</h3><p>​        因为一开始没有去参照学姐学长做的客栈的框架，所以这个项目的框架比较乱，一些组件的页面的位置也存放的不正确。希望以后的项目能够把公共组件和私有组件分开，组件和页面分开以形成更明晰的结构。以下是参照木犀客栈的结构：</p>
<figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">--src</span></span><br><span class="line">	<span class="params">--assets</span>     <span class="string">//</span>存放图片</span><br><span class="line">		<span class="params">--png</span></span><br><span class="line">		<span class="params">--svg</span></span><br><span class="line">	<span class="params">--components</span> <span class="string">//</span>存放组件</span><br><span class="line">		<span class="params">--common</span> <span class="string">//</span>公用组件</span><br><span class="line">		<span class="params">--index</span>  <span class="string">//</span>私有组件</span><br><span class="line">	<span class="params">--pages</span>      <span class="string">//</span>页面</span><br><span class="line">		<span class="params">--index</span></span><br><span class="line">			<span class="params">--index</span>.jsx</span><br><span class="line">	<span class="params">--service</span>	<span class="string">//Fech</span> API</span><br><span class="line">		<span class="params">--Fech</span>.jsx</span><br><span class="line">	<span class="params">--app</span>.jsx	 <span class="string">//</span>配置</span><br><span class="line">	<span class="params">--app</span>.scss	 <span class="string">//</span>样式</span><br><span class="line">	<span class="params">--index</span>.html <span class="string">//</span>接口</span><br></pre></td></tr></table></figure>

<p>一般来说一个项目的结构就如上所示了。</p>
<h3 id="二、Taro内置组件"><a href="#二、Taro内置组件" class="headerlink" title="二、Taro内置组件"></a>二、Taro内置组件</h3><p>​        刚刚开始写静态页面的时候使用错了组件，还是用的HTML的标签<code>&lt;div&gt; &lt;span&gt;</code>等。要注意以下代码的含义：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@tarojs/taro'</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Text,Image &#125; <span class="keyword">from</span> <span class="string">'@tarojs/components'</span></span><br></pre></td></tr></table></figure>

<p>​        Taro里面有内置的组件使用，<code>&lt;View&gt; &lt;Text&gt;</code>等类似于HTML中的标签使用。要注意的是，HTML中使用的class选择器，class关键字要改变成classname，因为关键字的保留class类。</p>
<p>这里的import也是webpack的方法吧，引入你需要的组件例如黑夜的头部和底部：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Head <span class="keyword">from</span> <span class="string">'../component/Head'</span></span><br><span class="line"><span class="keyword">import</span> Footer <span class="keyword">from</span> <span class="string">'../component/Footer'</span></span><br></pre></td></tr></table></figure>

<p>一定要from正确的路径<code>&#39;../&#39;</code>是返回上一级目录，也可以返回多次。</p>
<h3 id="三、Taro中的输入框"><a href="#三、Taro中的输入框" class="headerlink" title="三、Taro中的输入框"></a>三、Taro中的输入框</h3><p>​        Taro中的输入框也是Taro当中的内置组件也分为<code>input</code>和<code>textarea</code>，但是要大写<code>&lt;Input /&gt; &lt;Textarea /&gt;</code>，这里顺便提一下Taro里面所有组件开头都要大写。</p>
<p>​        输入框输入值的时候<code>value</code>要空，且还有监听事件函数<code>onInput</code>，<code>onChange</code>也可以。但是比较坑的事，<code>onInput</code>函数对于<code>Input</code>和<code>Textarea</code>不同。当时产品组给我提的要求是控制行数限制，这里也要说一下<code>Textarea</code>的特性，有换行的监听函数。但是由于<code>onInput</code>对于<code>Textarea</code>的<code>value</code>的改变不能显示于<code>Textarea</code>，而可以显示于<code>Input</code>。最后也是需求改成了字数限制。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;Textarea </span><br><span class="line">className=<span class="string">'write'</span> </span><br><span class="line">value=&#123;Value&#125; </span><br><span class="line">onInput=&#123;<span class="keyword">this</span>.handleInputChange.bind(<span class="keyword">this</span>)&#125; </span><br><span class="line">onFocus=&#123;<span class="keyword">this</span>.handleInput.bind(<span class="keyword">this</span>)&#125;</span><br><span class="line">onBlur=&#123;<span class="keyword">this</span>.handleback.bind(<span class="keyword">this</span>)&#125; </span><br><span class="line">showConfirmBar=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">maxlength=&#123;<span class="number">75</span>&#125;</span><br><span class="line">autoFocus=&#123;<span class="literal">true</span>&#125;</span><br><span class="line">&gt;<span class="xml"><span class="tag">&lt;/<span class="name">Textarea</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>​        组件的写法可以这样换行以更醒目的看见，太长不方便查看。但是一些<code>View</code>好像就不行。</p>
<h3 id="四、API"><a href="#四、API" class="headerlink" title="四、API"></a>四、API</h3><p>​        写整个项目前最重要的就是沟通，和产品沟通和后端沟通。没有沟通好的后果就是白天好像重新写页面的结构。还好因为黑夜也不难，所以没有做好沟通也影响不大。其中我觉得比较重要的是分页这个部分。因为要考虑到页面的实际需求来看分页的形式和需不需要分页。参考<code>swaggerUI</code>是一个很重要的东西，一定要反复比对。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">onReachBottom()&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.state.history.length % <span class="number">5</span> == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            page: <span class="keyword">this</span>.state.page + <span class="number">1</span></span><br><span class="line">        &#125;, () =&gt; &#123;</span><br><span class="line">            Fetch(<span class="string">`secret/history?page=<span class="subst">$&#123;<span class="keyword">this</span>.state.page&#125;</span>`</span>,</span><br><span class="line">                &#123;&#125;,</span><br><span class="line">                <span class="string">'GET'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                        history: <span class="keyword">this</span>.state.history.concat(res.history)</span><br><span class="line">                    &#125;)</span><br><span class="line">                &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​        这里是一个后端的分页方法，需要的事我每一次请求时发送一个页面数字给后端，他再返回给我对应数字的内容。这种分页方法个人感觉比较适合网页，而不适合小程序去写。所以我加了限定条件只有显示内容为5个时候才会进行下一次的请求。</p>
<p>​        API的路径一定要对，我举例困扰我很久的删除功能。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">handleDelete()&#123;</span><br><span class="line">        Fetch(<span class="string">`secret/delete/:secret_id/?secretId=<span class="subst">$&#123;<span class="keyword">this</span>.props.Debunkid&#125;</span>`</span>,</span><br><span class="line">        &#123;&#125;,</span><br><span class="line">        <span class="string">'DELETE'</span>).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123; </span><br><span class="line">        Taro.showToast(&#123;</span><br><span class="line">            title: <span class="string">'删除成功'</span>,</span><br><span class="line">            icon: <span class="string">'none'</span></span><br><span class="line">        &#125;)</span><br><span class="line">            <span class="keyword">this</span>.props.onCloseDelete() </span><br><span class="line">            Taro.reLaunch(&#123;</span><br><span class="line">                url:<span class="string">`/pages/Mine/Mine`</span></span><br><span class="line">            &#125;) </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>​        这里因为我少了一个<code>/</code>导致我应该不能与后端连接，但是开发者工具可以我也就没有想太多。牢记！！</p>
<h3 id="五、QQ授权和分享"><a href="#五、QQ授权和分享" class="headerlink" title="五、QQ授权和分享"></a>五、QQ授权和分享</h3><p>​        QQ授权和分享是要过审核必须写的一个API，我们也是事后才写的。</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button open-type=<span class="string">'getUserInfo'</span> className=<span class="string">'login'</span> onClick=&#123;<span class="keyword">this</span>.power&#125;&gt;登录&lt;<span class="regexp">/Button&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">power () &#123;</span><br><span class="line">        Taro.getSetting(&#123;</span><br><span class="line">            success: <span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">              <span class="keyword">this</span>.setState(&#123; <span class="attr">powered</span>:res.authSetting[<span class="string">'scope.userInfo'</span>]&#125;)</span><br><span class="line">              <span class="keyword">if</span> (res.authSetting[<span class="string">'scope.userInfo'</span>]) &#123;</span><br><span class="line">                  <span class="keyword">this</span>.onHandleLogin()</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Taro.showShareMenu(&#123;</span><br><span class="line">       showShareItems: [<span class="string">'qq'</span>, <span class="string">'qzone'</span>, <span class="string">'wechatFriends'</span>, <span class="string">'wechatMoment'</span>]</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>

<p>第一二个代码块是处理授权的部分，第三个是分享。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/09/22/%E7%80%9B%EF%B9%81%E2%82%AC%E5%B2%84%E3%80%89%E9%97%88%E3%88%A1%E2%82%AC%E8%8D%A4%E7%B2%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar1.jpg">
      <meta itemprop="name" content="HCLacids">
      <meta itemprop="description" content="Fighting!">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HCL's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2021/09/22/%E7%80%9B%EF%B9%81%E2%82%AC%E5%B2%84%E3%80%89%E9%97%88%E3%88%A1%E2%82%AC%E8%8D%A4%E7%B2%A8/" class="post-title-link" itemprop="url">瀛﹁€岄〉闈㈡€荤粨</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-09-22 10:40:49" itemprop="dateCreated datePublished" datetime="2021-09-22T10:40:49+08:00">2021-09-22</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-08 21:36:08" itemprop="dateModified" datetime="2019-11-08T21:36:08+08:00">2019-11-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="关于HTML和CSS的总结"><a href="#关于HTML和CSS的总结" class="headerlink" title="关于HTML和CSS的总结"></a>关于HTML和CSS的总结</h1><h6 id="在这两周时间，我写了静态的学而网页并进行了一些修改。在学姐学长的帮助和指导之下，我对网页的一些整体布局有所了解，以下为一些自己在写学而时犯下的错误。"><a href="#在这两周时间，我写了静态的学而网页并进行了一些修改。在学姐学长的帮助和指导之下，我对网页的一些整体布局有所了解，以下为一些自己在写学而时犯下的错误。" class="headerlink" title="在这两周时间，我写了静态的学而网页并进行了一些修改。在学姐学长的帮助和指导之下，我对网页的一些整体布局有所了解，以下为一些自己在写学而时犯下的错误。"></a>在这两周时间，我写了静态的学而网页并进行了一些修改。在学姐学长的帮助和指导之下，我对网页的一些整体布局有所了解，以下为一些自己在写学而时犯下的错误。</h6><h4 id="HEADER-PART"><a href="#HEADER-PART" class="headerlink" title="HEADER PART"></a>HEADER PART</h4><p>1.布局方式不要混用（其实适用于很多地方），<code>flex</code> <code>inline-block</code> 和<code>float</code>最好不要混合使用。</p>
<p>2.尽量减少div的使用。学会思考<code>span</code>和<code>div</code>的使用情况。<code>span</code>作为行内元素，可以用来标记一些行内特殊的元素；<code>div</code>作为块元素，更好的区分出每一个区域。有时候会用很多个<code>div</code>，变成<code>inline-block</code>的样子是因为在行内中出现了不同的功能区。</p>
<p>3.消除间隙。由于行内元素都是有间隙的所以一般需要消除间隙，例如图片与搜索框之间。</p>
<p>4.搜索框的写法，一般是用一个大的<code>div</code>把<code>input</code>和图片包裹起来，设置<code>div</code>的<code>border</code>的颜色来展示边框。</p>
<p>5.实现<code>:hover</code>之后，要确保前后元素的大小一致，这样才美观。</p>
<h4 id="MIDDLE-PART"><a href="#MIDDLE-PART" class="headerlink" title="MIDDLE PART"></a>MIDDLE PART</h4><p>1.整体布局，用一个<code>div</code>来使多个中间部分水平居中。</p>
<p>2.在整个页面中最好只采取一种布局方式。</p>
<p>3.<code>position：sticky</code>可以适用于更多的场合，也更符合如今的审美需求。</p>
<p>4.<code>input</code>的样式用CSS来改变</p>
<h4 id="FOOTER-PART"><a href="#FOOTER-PART" class="headerlink" title="FOOTER PART"></a>FOOTER PART</h4><p>1.注意字符间距</p>
<p>2.<code>body</code>的<code>margin</code>为0或者<code>padding</code>为0；</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="HCLacids"
    src="/images/avatar1.jpg">
  <p class="site-author-name" itemprop="name">HCLacids</p>
  <div class="site-description" itemprop="description">Fighting!</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/HCLacids" title="GitHub &amp;rarr; https:&#x2F;&#x2F;github.com&#x2F;HCLacids" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/en" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">HCLacids</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.5.0
  </div>

        












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

</body>
</html>
